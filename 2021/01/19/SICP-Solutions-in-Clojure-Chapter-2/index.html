<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"glyh.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Exercise 2.1 1234(defn make-rat [n d]   (let [g (gcd n d) nf (&#x2F; n g) df (&#x2F; d g)]     (if (&lt; df 0) (list (- nf) (- df))                       (list nf df) )))  Exercise 2.2 12345678910111213(defn m">
<meta property="og:type" content="article">
<meta property="og:title" content="SICP Solutions in Clojure (Chapter 2)">
<meta property="og:url" content="https://glyh.github.io/2021/01/19/SICP-Solutions-in-Clojure-Chapter-2/">
<meta property="og:site_name" content="Newbie@Corner">
<meta property="og:description" content="Exercise 2.1 1234(defn make-rat [n d]   (let [g (gcd n d) nf (&#x2F; n g) df (&#x2F; d g)]     (if (&lt; df 0) (list (- nf) (- df))                       (list nf df) )))  Exercise 2.2 12345678910111213(defn m">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://glyh.github.io/2021/01/19/SICP-Solutions-in-Clojure-Chapter-2/2-71-hoffman-tree-example.png">
<meta property="article:published_time" content="2021-01-19T13:18:46.000Z">
<meta property="article:modified_time" content="2021-02-02T10:17:37.938Z">
<meta property="article:author" content="Lyhokia">
<meta property="article:tag" content="algorithms">
<meta property="article:tag" content="principles">
<meta property="article:tag" content="SICP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://glyh.github.io/2021/01/19/SICP-Solutions-in-Clojure-Chapter-2/2-71-hoffman-tree-example.png">

<link rel="canonical" href="https://glyh.github.io/2021/01/19/SICP-Solutions-in-Clojure-Chapter-2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>SICP Solutions in Clojure (Chapter 2) | Newbie@Corner</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Newbie@Corner</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://glyh.github.io/2021/01/19/SICP-Solutions-in-Clojure-Chapter-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Lyhokia">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Newbie@Corner">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SICP Solutions in Clojure (Chapter 2)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-19 21:18:46" itemprop="dateCreated datePublished" datetime="2021-01-19T21:18:46+08:00">2021-01-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-02 18:17:37" itemprop="dateModified" datetime="2021-02-02T18:17:37+08:00">2021-02-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/IT/" itemprop="url" rel="index"><span itemprop="name">IT</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/IT/science/" itemprop="url" rel="index"><span itemprop="name">science</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h4 id="exercise-21"><a class="markdownIt-Anchor" href="#exercise-21"></a> Exercise 2.1</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">make-rat</span> [n d] </span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [g (<span class="name">gcd</span> n d) nf (/ n g) df (/ d g)] </span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> df <span class="number">0</span>) (<span class="name"><span class="builtin-name">list</span></span> (<span class="name"><span class="builtin-name">-</span></span> nf) (<span class="name"><span class="builtin-name">-</span></span> df)) </span><br><span class="line">                      (<span class="name"><span class="builtin-name">list</span></span> nf df) )))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-22"><a class="markdownIt-Anchor" href="#exercise-22"></a> Exercise 2.2</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">make-point</span> [x y] (<span class="name"><span class="builtin-name">list</span></span> x y))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">x-point</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">y-point</span> second)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-segment</span> [s t] (<span class="name"><span class="builtin-name">list</span></span> s t))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">start-segment</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">end-segment</span> second)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">midpoint-segment</span> [seg] </span><br><span class="line">  (<span class="name"><span class="builtin-name">map</span></span> #(/ (<span class="name"><span class="builtin-name">+</span></span> (% (<span class="name">start-segment</span> seg)) (% (<span class="name">end-segment</span> seg))) <span class="number">2</span>) </span><br><span class="line">       [x-point y-point]))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">print-point</span> [p] (<span class="name"><span class="builtin-name">prn</span></span> (<span class="name"><span class="builtin-name">str</span></span> <span class="string">&quot;(&quot;</span> (<span class="name">x-point</span> p) <span class="string">&quot;, &quot;</span> (<span class="name">y-point</span> p) <span class="string">&quot;)&quot;</span>)))</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="exercise-23"><a class="markdownIt-Anchor" href="#exercise-23"></a> Exercise 2.3</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">; Implementation 1</span></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-rectangle</span> [p1 p2] (<span class="name"><span class="builtin-name">list</span></span> p1 p2)) </span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">abs</span> #(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> % <span class="number">0</span>) (<span class="name"><span class="builtin-name">-</span></span> %) %))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">diff</span> [f a b] (<span class="name">abs</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">f</span> a) (<span class="name">f</span> b))))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">width</span> #(<span class="name">diff</span> x-point (<span class="name">start-segment</span> %) (<span class="name">end-segment</span> %)))<span class="comment">; segment refers to rectangle&#x27;s main diagonal</span></span><br><span class="line">(<span class="keyword">def</span> <span class="title">height</span> #(<span class="name">diff</span> y-point (<span class="name">start-segment</span> %) (<span class="name">end-segment</span> %)))</span><br><span class="line"></span><br><span class="line"><span class="comment">; Implementation 2</span></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-rectangle</span> [p-topleft size] (<span class="name"><span class="builtin-name">list</span></span> p-topleft size))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">size-rectangle</span> [rect] (<span class="name"><span class="builtin-name">second</span></span> rect))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">width</span> [rect] (<span class="name"><span class="builtin-name">first</span></span> (<span class="name">size-rectangle</span> rect)))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">height</span> [rect] (<span class="name"><span class="builtin-name">second</span></span> (<span class="name">size-rectangle</span> rect)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">perimeter</span> [rect] (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">width</span> rect) (<span class="name">height</span> rect))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">area</span> [rect] (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">width</span> rect) (<span class="name">height</span> rect)))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="exercise-24"><a class="markdownIt-Anchor" href="#exercise-24"></a> Exercise 2.4</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">cons</span> [x y] #(% x y))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">car</span> [z] (<span class="name">z</span> (<span class="name"><span class="builtin-name">fn</span></span> [p q] p)))</span><br><span class="line"></span><br><span class="line">(<span class="name">car</span> (<span class="name"><span class="builtin-name">cons</span></span> x y))<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="name">car</span> #(% x y))<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="name">#</span>(% x y) (<span class="name"><span class="builtin-name">fn</span></span> [p q] p))<span class="comment">; =&gt;</span></span><br><span class="line">((<span class="name"><span class="builtin-name">fn</span></span> [p q] p) x y)<span class="comment">; =&gt;</span></span><br><span class="line">x </span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">cdr</span> [z] (<span class="name">z</span> (<span class="name"><span class="builtin-name">fn</span></span> [p q] q)))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-25"><a class="markdownIt-Anchor" href="#exercise-25"></a> Exercise 2.5</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">cons</span> [x y] (<span class="name"><span class="builtin-name">int</span></span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">Math/pow</span> <span class="number">2</span> x) (<span class="name">Math/pow</span> <span class="number">3</span> y))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">cdr</span> [z] </span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">iter</span> [z result] (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">rem</span></span> z <span class="number">3</span>) <span class="number">0</span>) (<span class="name"><span class="builtin-name">recur</span></span> (/ z <span class="number">3</span>) (<span class="name"><span class="builtin-name">+</span></span> result <span class="number">1</span>))result ))</span><br><span class="line">  (<span class="name">iter</span> z <span class="number">0</span>))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">car</span> [z] </span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">iter</span> [z result] (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">rem</span></span> z <span class="number">2</span>) <span class="number">0</span>) (<span class="name"><span class="builtin-name">recur</span></span> (/ z <span class="number">2</span>) (<span class="name"><span class="builtin-name">+</span></span> result <span class="number">1</span>))result ))</span><br><span class="line">  (<span class="name">iter</span> z <span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-26"><a class="markdownIt-Anchor" href="#exercise-26"></a> Exercise 2.6</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">add-1</span> zero)<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="name"><span class="builtin-name">fn</span></span> [f] (<span class="name"><span class="builtin-name">fn</span></span> [x] (<span class="name">f</span> ((<span class="name">zero</span> f) x))))<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="name"><span class="builtin-name">fn</span></span> [f] (<span class="name"><span class="builtin-name">fn</span></span> [x] (<span class="name">f</span> ((<span class="name"><span class="builtin-name">fn</span></span> [x] x) x))))<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="name"><span class="builtin-name">fn</span></span> [f] (<span class="name"><span class="builtin-name">fn</span></span> [x] (<span class="name">f</span> x)))<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="keyword">def</span> <span class="title">one</span> (<span class="name"><span class="builtin-name">fn</span></span> [f] (<span class="name"><span class="builtin-name">fn</span></span>[x] (<span class="name">f</span> x))))<span class="comment">; </span></span><br><span class="line"></span><br><span class="line">(<span class="name">add-1</span> one)<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="name"><span class="builtin-name">fn</span></span> [f] (<span class="name"><span class="builtin-name">fn</span></span> [x] (<span class="name">f</span> ((<span class="name">one</span> f) x))))<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="name"><span class="builtin-name">fn</span></span> [f] (<span class="name"><span class="builtin-name">fn</span></span> [x] (<span class="name">f</span> ((<span class="name"><span class="builtin-name">fn</span></span>[x] (<span class="name">f</span> x)) x))))<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="name"><span class="builtin-name">fn</span></span> [f] (<span class="name"><span class="builtin-name">fn</span></span> [x] (<span class="name">f</span> (<span class="name">f</span> x))))<span class="comment">; =&gt;</span></span><br><span class="line">(<span class="keyword">def</span> <span class="title">two</span> (<span class="name"><span class="builtin-name">fn</span></span> [f] (<span class="name"><span class="builtin-name">fn</span></span> [x] (<span class="name">f</span> (<span class="name">f</span> x)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">+</span> [a b] (<span class="name">a</span> b))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-27"><a class="markdownIt-Anchor" href="#exercise-27"></a> Exercise 2.7</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">lower-bound</span> first)</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">upper-bound</span> second)</span><br></pre></td></tr></table></figure>
<h4 id="exercise-28"><a class="markdownIt-Anchor" href="#exercise-28"></a> Exercise 2.8</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">sub-interval</span> [I1 I2] (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">lower-bound</span> I1) (<span class="name">upper-bound</span> I2)) (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">upper-bound</span> I1) (<span class="name">lower-bound</span> I2))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-29"><a class="markdownIt-Anchor" href="#exercise-29"></a> Exercise 2.9</h4>
<p>For addition:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>l</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mn>1</mn></msub><mo>+</mo><msub><mi>l</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><msub><mi>h</mi><mn>1</mn></msub><mo>=</mo><msub><mi>r</mi><mn>1</mn></msub><mo>−</mo><msub><mi>l</mi><mn>1</mn></msub><mspace linebreak="newline"></mspace><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><msub><mi>h</mi><mn>2</mn></msub><mo>=</mo><msub><mi>r</mi><mn>2</mn></msub><mo>−</mo><msub><mi>l</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><msub><mi>h</mi><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mn>1</mn></msub><mo>+</mo><msub><mi>l</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><msub><mi>h</mi><mn>1</mn></msub><mo>+</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><msub><mi>h</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">(l_1, r_1) + (l_2, r_2) = (l_1 + l_2, r_1 + r_2)\newline
width_1 = r_1 - l_1\newline
width_2 = r_2 - l_2\newline
width_3 = (r_1+r_2)-(l_1+l_2)=width_1+width_2\newline
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span></p>
<p>For substraction:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>l</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><msub><mi>r</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>−</mo><msub><mi>l</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">(l_1, r_1) - (l_2, r_2) = (l_1, r_1) + (-r_2, -l_2)\newline
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span></p>
<p>So this becomes addition.</p>
<p>For multiplication:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>8</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 2) \times (1, 2) = (1, 4)\newline
(1, 2) \times (3, 4) = (3, 8)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mclose">)</span></span></span></span></span></p>
<p>All factors have width of 1, but their products’ width are not the same.</p>
<p>For division:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>÷</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>÷</mo><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><mo separator="true">,</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 2) \div (1,2) = (\frac12, 2)\newline
(1, 2) \div (3, 4) = (\frac14, \frac23)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">÷</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord">2</span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">÷</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord">4</span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">1</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord">3</span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord">2</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>All input intervals have width of 1, but their quotients’ width are not the same.</p>
<h4 id="exercise-210"><a class="markdownIt-Anchor" href="#exercise-210"></a> Exercise 2.10</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">div-interval</span> [x y]</span><br><span class="line">   (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> (<span class="name">lower-bound</span> y) <span class="number">0</span> (<span class="name">upper-bound</span> y)) (<span class="name"><span class="builtin-name">throw</span></span> (<span class="name">Throwable.</span> <span class="string">&quot;Divded by a interval that spans 0&quot;</span>)))</span><br><span class="line">   (<span class="name">mul-interval</span> x (<span class="name">make-interval</span> (/ <span class="number">1.0</span> (<span class="name">upper-bound</span> y)) (/ <span class="number">1.0</span> (<span class="name">lower-bound</span> y)))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-211"><a class="markdownIt-Anchor" href="#exercise-211"></a> Exercise 2.11</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">mul-interval</span> [x y] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&gt;=</span></span> (<span class="name">lower-bound</span> x) <span class="number">0</span>) (<span class="name"><span class="builtin-name">&gt;=</span></span> (<span class="name">lower-bound</span> y) <span class="number">0</span>)) </span><br><span class="line">          (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">lower-bound</span> x) (<span class="name">lower-bound</span> y)) (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">upper-bound</span> x) (<span class="name">upper-bound</span> y)))</span><br><span class="line">        (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&gt;=</span></span> (<span class="name">lower-bound</span> x) <span class="number">0</span>) (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name">lower-bound</span> y) <span class="number">0</span> (<span class="name">upper-bound</span> y)))</span><br><span class="line">          (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">upper-bound</span> x) (<span class="name">lower-bound</span> y)) (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">upper-bound</span> x) (<span class="name">upper-bound</span> y)))</span><br><span class="line">        (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&gt;=</span></span> (<span class="name">lower-bound</span> x) <span class="number">0</span>) (<span class="name"><span class="builtin-name">&lt;=</span></span> (<span class="name">upper-bound</span> y) <span class="number">0</span>))</span><br><span class="line">          (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">upper-bound</span> x) (<span class="name">lower-bound</span> y)) (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">lower-bound</span> x) (<span class="name">upper-bound</span> y)))</span><br><span class="line">        (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name">lower-bound</span> x) <span class="number">0</span> (<span class="name">upper-bound</span> x)) (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name">lower-bound</span> y) <span class="number">0</span> (<span class="name">upper-bound</span> y)))</span><br><span class="line">          (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">max</span></span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">upper-bound</span> x) (<span class="name">lower-bound</span> y)) (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">lower-bound</span> x) (<span class="name">upper-bound</span> y)))</span><br><span class="line">                         (<span class="name"><span class="builtin-name">max</span></span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">lower-bound</span> x) (<span class="name">lower-bound</span> y)) (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">upper-bound</span> x) (<span class="name">upper-bound</span> y))))</span><br><span class="line">        (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name">lower-bound</span> x) <span class="number">0</span> (<span class="name">upper-bound</span> x)) (<span class="name"><span class="builtin-name">&lt;=</span></span> (<span class="name">upper-bound</span> y) <span class="number">0</span>))</span><br><span class="line">          (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">upper-bound</span> x) (<span class="name">lower-bound</span> y)) (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">lower-bound</span> x) (<span class="name">lower-bound</span> y)))</span><br><span class="line">        (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&lt;=</span></span> (<span class="name">upper-bound</span> x) <span class="number">0</span>) (<span class="name"><span class="builtin-name">&lt;=</span></span> (<span class="name">upper-bound</span> y) <span class="number">0</span>))</span><br><span class="line">          (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">upper-bound</span> x) (<span class="name">upper-bound</span> y)) (<span class="name"><span class="builtin-name">*</span></span> (<span class="name">lower-bound</span> x) (<span class="name">lower-bound</span> y)))</span><br><span class="line">        <span class="symbol">:else</span></span><br><span class="line">          (<span class="name">mul-interval</span> y x)))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-212"><a class="markdownIt-Anchor" href="#exercise-212"></a> Exercise 2.12</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">make-center-width</span> [c w]</span><br><span class="line">  (<span class="name">make-interval</span> (<span class="name"><span class="builtin-name">-</span></span> c w) (<span class="name"><span class="builtin-name">+</span></span> c w)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">center</span> [i]</span><br><span class="line">  (/ (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">lower-bound</span> i) </span><br><span class="line">        (<span class="name">upper-bound</span> i)) </span><br><span class="line">     <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">width</span> [i]</span><br><span class="line">  (/ (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">upper-bound</span> i) </span><br><span class="line">        (<span class="name">lower-bound</span> i)) </span><br><span class="line">     <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-center-percent</span> [c p] (<span class="name">make-center-width</span> c (<span class="name"><span class="builtin-name">*</span></span> c p)))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">percent</span> [I] (/ (<span class="name">width</span> I)  (<span class="name">center</span> I)))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-213"><a class="markdownIt-Anchor" href="#exercise-213"></a> Exercise 2.13</h4>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mo>−</mo><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo>−</mo><mi>p</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>I</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mo>−</mo><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo>−</mo><mi>p</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mn>2</mn></msub><mo>&gt;</mo><mn>0</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtable rowspacing="0.24999999999999992em" columnalign="right left right left right" columnspacing="0em 1em 0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>I</mi><mn>1</mn></msub><mo>×</mo><msub><mi>I</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>c</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>c</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>c</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mo>=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">(</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo>−</mo><mo stretchy="false">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo>+</mo><msub><mi>p</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo>+</mo><mo stretchy="false">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo>+</mo><msub><mi>p</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr></mtable><mspace linebreak="newline"></mspace><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>I</mi><mn>1</mn></msub><mo>×</mo><msub><mi>I</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo>+</mo><msub><mi>p</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace><mi>p</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>I</mi><mn>1</mn></msub><mo>×</mo><msub><mi>I</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub></mrow><mrow><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><mo>+</mo><msub><mi>p</mi><mn>1</mn></msub><msub><mi>p</mi><mn>2</mn></msub><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub></mrow></mfrac><mspace linebreak="newline"></mspace><mtable rowspacing="0.24999999999999992em" columnalign="right left right left right left" columnspacing="0em 1em 0em 1em 0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∵</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>&lt;</mo><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo>&lt;</mo><mo>&lt;</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∴</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>I</mi><mn>1</mn></msub><mo>×</mo><msub><mi>I</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≈</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>p</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>I</mi><mn>1</mn></msub><mo>×</mo><msub><mi>I</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≈</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><msub><mi>p</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">I_1:= make-center-percent(c_1, p_1) (c_1 &gt; 0) \newline
I_2:= make-center-percent(c_2, p_2) (c_2 &gt; 0) \newline
\begin{aligned}
&amp;I_1 \times I_2 &amp;=&amp; (c_1(1 - p_1)c_2(1 - p_2), c_1 (1 + p_1) c_2 (1+p_2))&amp; \\
&amp;&amp;=&amp;(c_1c_2-(p_1 + p_2)c_1c_2+p_1p_2c_1c_2, c_1c_2+(p_1 + p_2)c_1c_2+p_1p_2c_1c_2)&amp;
\end{aligned} \newline
center(I_1 \times I_2) = c_1c_2 + p_1p_2c_1c_2 \newline
percent(I_1 \times I_2) = \frac{(p_1 + p_2)c_1c_2}{c_1c_2 + p_1p_2c_1c_2} \newline
\begin {aligned}
&amp; \because &amp;p_1 &lt;&lt; 1, p_2 &lt;&lt; 1 \\
&amp;\therefore &amp;center(I_1 \times I_2) &amp;\approx&amp; c_1 c_2 &amp; \\
&amp;&amp; percent(I_1 \times I_2) &amp;\approx&amp; p_1 + p_2 &amp;
\end {aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:3.0000000000000004em;vertical-align:-1.2500000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel">=</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.30744em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.5em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-1.4999999999999991em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∵</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∴</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0000000000000002em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0000000000000002em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0000000000000002em;"><span style="top:-3em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-1.4999999999999991em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"><span class="mord"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h4 id="exercise-214"><a class="markdownIt-Anchor" href="#exercise-214"></a> Exercise 2.14</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">par1</span> [r1 r2] (<span class="name">div-interval</span> (<span class="name">mul-interval</span> r1 r2) (<span class="name">add-interval</span> r1 r2)))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">par2</span> [r1 r2] (<span class="name"><span class="builtin-name">let</span></span> [one (<span class="name">make-interval</span> <span class="number">1</span> <span class="number">1</span>)] (<span class="name">div-interval</span> one (<span class="name">add-interval</span> (<span class="name">div-interval</span> one r1) (<span class="name">div-interval</span> one r2)))))</span><br></pre></td></tr></table></figure>
<p>The error occurs because <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>÷</mo><mi>A</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A \div A = (1, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">÷</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> is not guaranteed in interval calculation.</p>
<h4 id="exercise-215"><a class="markdownIt-Anchor" href="#exercise-215"></a> Exercise 2.15</h4>
<p>Yes, she is. Avoiding the same variable invloves into the calculation twice can help us avoid the occasion in Exercise 2.14.</p>
<h4 id="exercise-216"><a class="markdownIt-Anchor" href="#exercise-216"></a> Exercise 2.16</h4>
<p>My first thought is that, programming is mostly engineering rather than theory.</p>
<p>Engineering is always bothered with the complexity of the real world, you should consider the comsumption of resources but in theory you don’t.</p>
<p>For example, computer can only approximate e, but in theory you just pick a sign representing it. (Space is limited, however, the information needed to represent e is infinite. )</p>
<p>I don’t think “to design an interval-arithmetic package that does not have this shortcoming” is possible.</p>
<p>As long as you use one name mutiple times to refers to some variant, the problem in 2.14 will happen.</p>
<h4 id="exercise-217"><a class="markdownIt-Anchor" href="#exercise-217"></a> Exercise 2.17</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">last-pair</span> [L] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">nil?</span></span> (<span class="name"><span class="builtin-name">second</span></span> L)) L (<span class="name"><span class="builtin-name">recur</span></span> (<span class="name"><span class="builtin-name">rest</span></span> L))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-218"><a class="markdownIt-Anchor" href="#exercise-218"></a> Exercise 2.18</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">reverse</span> [L] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> L) L (<span class="name"><span class="builtin-name">concat</span></span> (<span class="name"><span class="builtin-name">reverse</span></span> (<span class="name"><span class="builtin-name">rest</span></span> L)) (<span class="name"><span class="builtin-name">list</span></span> (<span class="name"><span class="builtin-name">first</span></span> L)))))  </span><br></pre></td></tr></table></figure>
<h4 id="exercise-219"><a class="markdownIt-Anchor" href="#exercise-219"></a> Exercise 2.19</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">no-more?</span> empty?)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">first-denomination</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">except-first-denomination</span> rest)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">us-coins</span> &#x27;(<span class="number">50</span> <span class="number">25</span> <span class="number">10</span> <span class="number">5</span> <span class="number">1</span>))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">unordered-us-coins</span> &#x27;(<span class="number">25</span> <span class="number">1</span> <span class="number">50</span> <span class="number">5</span> <span class="number">10</span>))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">uk-coins</span> &#x27;(<span class="number">100</span> <span class="number">50</span> <span class="number">20</span> <span class="number">10</span> <span class="number">5</span> <span class="number">2</span> <span class="number">1</span> <span class="number">0.5</span>))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">cc</span> (<span class="name"><span class="builtin-name">memoize</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [amount coins-list]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">=</span></span> amount <span class="number">0</span>) <span class="number">1</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">&lt;</span></span> amount <span class="number">0</span>) (<span class="name">no-more?</span> coins-list)) <span class="number">0</span></span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">cc</span> amount (<span class="name">except-first-denomination</span> coins-list))</span><br><span class="line">                 (<span class="name">cc</span> (<span class="name"><span class="builtin-name">-</span></span> amount (<span class="name">first-denomination</span> coins-list)) coins-list))))))</span><br><span class="line">(<span class="name">cc</span> <span class="number">100</span> us-coins)</span><br><span class="line">(<span class="name">cc</span> <span class="number">100</span> unordered-us-coins)</span><br></pre></td></tr></table></figure>
<p>The order of the list coins-list doesn’t affect the answer produced by cc.</p>
<p>This is because the order of the coins are irrelevant to the plans to change the money.</p>
<h4 id="exercise-220"><a class="markdownIt-Anchor" href="#exercise-220"></a> Exercise 2.20</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">same-parity</span> [a &amp; args]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> args) (<span class="name"><span class="builtin-name">list</span></span> a)</span><br><span class="line">    (<span class="name"><span class="builtin-name">let</span></span> [b (<span class="name"><span class="builtin-name">first</span></span> args)]</span><br><span class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">rem</span></span> (<span class="name"><span class="builtin-name">-</span></span> b a) <span class="number">2</span>) <span class="number">0</span>)</span><br><span class="line">        (<span class="name"><span class="builtin-name">concat</span></span> (<span class="name"><span class="builtin-name">list</span></span> a) (<span class="name"><span class="builtin-name">apply</span></span> same-parity b (<span class="name"><span class="builtin-name">rest</span></span> args)))</span><br><span class="line">        (<span class="name"><span class="builtin-name">apply</span></span> same-parity a (<span class="name"><span class="builtin-name">rest</span></span> args))))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-221"><a class="markdownIt-Anchor" href="#exercise-221"></a> Exercise 2.21</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">square-list</span> [items]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> items) &#x27;() (<span class="name"><span class="builtin-name">concat</span></span> (<span class="name"><span class="builtin-name">let</span></span> [a (<span class="name"><span class="builtin-name">first</span></span> items)] (<span class="name"><span class="builtin-name">list</span></span> (<span class="name"><span class="builtin-name">*</span></span> a a))) (<span class="name">square-list</span> (<span class="name"><span class="builtin-name">rest</span></span> items)))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">square-list</span> [items] (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name"><span class="builtin-name">*</span></span> % %) items))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-222"><a class="markdownIt-Anchor" href="#exercise-222"></a> Exercise 2.22</h4>
<p>The function <code>cons</code> kept pushing elemnets to the front of the array.</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">square</span> #(<span class="name"><span class="builtin-name">*</span></span> % %))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">square-list</span> [items]</span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">iter</span> [things answer] </span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> things) answer </span><br><span class="line">      (<span class="name"><span class="builtin-name">recur</span></span> (<span class="name"><span class="builtin-name">rest</span></span> things) (<span class="name"><span class="builtin-name">concat</span></span> answer (<span class="name"><span class="builtin-name">list</span></span> (<span class="name">square</span> (<span class="name"><span class="builtin-name">first</span></span> things)))))))</span><br><span class="line">  (<span class="name">iter</span> items &#x27;()))</span><br></pre></td></tr></table></figure>
<p>This works for me… Maybe it’s only because the call to iter in Scheme gives <code>nil</code> as the first element in the list.</p>
<h4 id="exercise-223"><a class="markdownIt-Anchor" href="#exercise-223"></a> Exercise 2.23</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">for-each</span> [f col] (<span class="name"><span class="builtin-name">map</span></span> f col) <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">for-each</span> [f col] (<span class="name"><span class="builtin-name">map</span></span> f col))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">for-each</span> [f col] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> col)) (<span class="name"><span class="builtin-name">do</span></span> (<span class="name">f</span> (<span class="name"><span class="builtin-name">first</span></span> col)) (<span class="name"><span class="builtin-name">recur</span></span> f (<span class="name"><span class="builtin-name">rest</span></span> col)))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-224"><a class="markdownIt-Anchor" href="#exercise-224"></a> Exercise 2.24</h4>
<p>Result by the interpreter : (1 (2 (3 4)))</p>
<p>Graphs are omited.</p>
<h4 id="exercise-225"><a class="markdownIt-Anchor" href="#exercise-225"></a> Exercise 2.25</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">-&gt;</span></span> &#x27;(<span class="number">1</span> <span class="number">3</span> (<span class="number">5</span> <span class="number">7</span>) <span class="number">9</span>) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">first</span></span>) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">first</span></span>))</span><br><span class="line">(<span class="name"><span class="builtin-name">-&gt;</span></span> &#x27;((<span class="number">7</span>)) (<span class="name"><span class="builtin-name">first</span></span>) (<span class="name"><span class="builtin-name">first</span></span>))</span><br><span class="line">(<span class="name"><span class="builtin-name">-&gt;</span></span> &#x27;(<span class="number">1</span> (<span class="number">2</span> (<span class="number">3</span> (<span class="number">4</span> (<span class="number">5</span> (<span class="number">6</span> <span class="number">7</span>)))))) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">first</span></span>) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">first</span></span>) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">first</span></span>) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">first</span></span>) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">first</span></span>) (<span class="name"><span class="builtin-name">rest</span></span>) (<span class="name"><span class="builtin-name">first</span></span>))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-226"><a class="markdownIt-Anchor" href="#exercise-226"></a> Exercise 2.26</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">conj</span></span> [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>] [<span class="number">4</span> <span class="number">5</span> <span class="number">6</span>])</span><br><span class="line">(<span class="name"><span class="builtin-name">concat</span></span> &#x27;(<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>) &#x27;(<span class="number">4</span> <span class="number">5</span> <span class="number">6</span>))</span><br><span class="line">(<span class="name"><span class="builtin-name">list</span></span> &#x27;(<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>) &#x27;(<span class="number">4</span> <span class="number">5</span> <span class="number">6</span>))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-227"><a class="markdownIt-Anchor" href="#exercise-227"></a> Exercise 2.27</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">deep-reverse</span> [L] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> L) L (<span class="name"><span class="builtin-name">concat</span></span> (<span class="name">deep-reverse</span> (<span class="name"><span class="builtin-name">rest</span></span> L)) (<span class="name"><span class="builtin-name">list</span></span> (<span class="name"><span class="builtin-name">let</span></span> [a (<span class="name"><span class="builtin-name">first</span></span> L)] (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">list?</span></span> a) (<span class="name">deep-reverse</span> a) a))))))  </span><br></pre></td></tr></table></figure>
<h4 id="exercise-228"><a class="markdownIt-Anchor" href="#exercise-228"></a> Exercise 2.28</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">fringe</span> [n] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> n) </span><br><span class="line">    n</span><br><span class="line">    (<span class="name"><span class="builtin-name">concat</span></span> (<span class="name"><span class="builtin-name">let</span></span> [a (<span class="name"><span class="builtin-name">first</span></span> n)] (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">list?</span></span> a) (<span class="name">fringe</span> a) (<span class="name"><span class="builtin-name">list</span></span> a)) ) </span><br><span class="line">            (<span class="name">fringe</span> (<span class="name"><span class="builtin-name">rest</span></span> n))))) </span><br></pre></td></tr></table></figure>
<h4 id="exercise-229"><a class="markdownIt-Anchor" href="#exercise-229"></a> Exercise 2.29</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">left-branch</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">right-branch</span> second)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">length</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">structure</span> second)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">total-weight</span> [m]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">list?</span></span> m) (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">total-weight</span> (<span class="name">structure</span> (<span class="name">left-branch</span> m))) (<span class="name">total-weight</span> (<span class="name">structure</span> (<span class="name">right-branch</span> m)))) m))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">balanced?</span></span><br><span class="line">  ([m] (<span class="name"><span class="builtin-name">&gt;=</span></span> (<span class="name">balanced?</span> m <span class="literal">true</span>)))</span><br><span class="line">  ([m success] </span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">list?</span></span> m) </span><br><span class="line">      (<span class="name"><span class="builtin-name">let</span></span> [bl (<span class="name">balanced</span> (<span class="name">structure</span> (<span class="name">left-branch</span> m))) br (<span class="name">balanced</span> (<span class="name">structure</span> (<span class="name">right-branch</span> m)))] </span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">and</span></span> success (<span class="name"><span class="builtin-name">&gt;=</span></span> bl <span class="number">0</span>) (<span class="name"><span class="builtin-name">&gt;=</span></span> br <span class="number">0</span>) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">*</span></span> bl (<span class="name">length</span> (<span class="name">left-branch</span> m))) (<span class="name"><span class="builtin-name">*</span></span> br (<span class="name">length</span> (<span class="name">right-branch</span> m))))) </span><br><span class="line">          (<span class="name"><span class="builtin-name">+</span></span> bl br) <span class="number">-1</span>))</span><br><span class="line">      m))) </span><br></pre></td></tr></table></figure>
<p>Only 4 functions, <code>left-branch</code>, <code>right-branch</code>, <code>length</code> and <code>structure</code>.</p>
<p>(Actually in the Clojure implementation there’s nothing to change.</p>
<h4 id="exercise-230"><a class="markdownIt-Anchor" href="#exercise-230"></a> Exercise 2.30</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">square-tree</span> [n] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">list?</span></span> n) (<span class="name"><span class="builtin-name">list</span></span> (<span class="name">square-tree</span> (<span class="name"><span class="builtin-name">first</span></span> n)) (<span class="name">square-tree</span> (<span class="name"><span class="builtin-name">second</span></span> n))) (<span class="name"><span class="builtin-name">*</span></span> n n)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">square-tree</span> [n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">list?</span></span> n) (<span class="name"><span class="builtin-name">map</span></span> square-tree n) (<span class="name"><span class="builtin-name">*</span></span> n n)))</span><br></pre></td></tr></table></figure>
<p>The second implementation is better, since it can deal with non-binary trees.</p>
<h4 id="exercise-231"><a class="markdownIt-Anchor" href="#exercise-231"></a> Exercise 2.31</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">tree-map</span> [f n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">node?</span> n) (<span class="name">f</span> n) (<span class="name"><span class="builtin-name">map</span></span> (<span class="name"><span class="builtin-name">partial</span></span> tree-map f) n)))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-232"><a class="markdownIt-Anchor" href="#exercise-232"></a> Exercise 2.32</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">subsets</span> [s]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> s)</span><br><span class="line">    &#x27;(())</span><br><span class="line">    (<span class="name"><span class="builtin-name">let</span></span> [s&#x27; (<span class="name">subsets</span> (<span class="name"><span class="builtin-name">rest</span></span> s)) a (<span class="name"><span class="builtin-name">first</span></span> s)] </span><br><span class="line">      (<span class="name"><span class="builtin-name">concat</span></span> s&#x27; (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name"><span class="builtin-name">conj</span></span> % a) s&#x27;)))))</span><br></pre></td></tr></table></figure>
<p>The application keeps reduce the size of a problem until it can be solve in constant time,</p>
<p>then merge the solutions of sub problems until we have the solution of the original problem.</p>
<h4 id="exercise-233"><a class="markdownIt-Anchor" href="#exercise-233"></a> Exercise 2.33</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">map</span> [p sequence] (<span class="name"><span class="builtin-name">reduce</span></span> #(<span class="name"><span class="builtin-name">conj</span></span> %<span class="number">1</span> (<span class="name">p</span> %<span class="number">2</span>)) [] sequence))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">append</span> [seq1 seq2] (<span class="name"><span class="builtin-name">reduce</span></span> #(<span class="name"><span class="builtin-name">conj</span></span> %<span class="number">1</span> %<span class="number">2</span>) (<span class="name"><span class="builtin-name">vec</span></span> seq1) seq2))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">length</span> [sequence] (<span class="name"><span class="builtin-name">reduce</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [x y] (<span class="name"><span class="builtin-name">inc</span></span> x)) <span class="number">0</span> sequence))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-234"><a class="markdownIt-Anchor" href="#exercise-234"></a> Exercise 2.34</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">horner-eval</span> [x Cs] </span><br><span class="line">  (<span class="name"><span class="builtin-name">reduce</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [cur C_i] (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">*</span></span> cur x) C_i)) <span class="number">0</span> (<span class="name"><span class="builtin-name">reverse</span></span> Cs)))</span><br><span class="line">(<span class="name">horner-eval</span> <span class="number">2</span> &#x27;(<span class="number">1</span> <span class="number">3</span> <span class="number">0</span> <span class="number">5</span> <span class="number">0</span> <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-235"><a class="markdownIt-Anchor" href="#exercise-235"></a> Exercise 2.35</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">count-leaves</span> [n] (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">list?</span></span> n) (<span class="name"><span class="builtin-name">reduce</span></span> + <span class="number">0</span> (<span class="name"><span class="builtin-name">map</span></span> count-leaves n)) <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-236"><a class="markdownIt-Anchor" href="#exercise-236"></a> Exercise 2.36</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">accumulate-n</span> [op init seqs]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> (<span class="name"><span class="builtin-name">first</span></span> seqs)) ()</span><br><span class="line">    (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">accumulate-n</span> op init (<span class="name"><span class="builtin-name">map</span></span> rest seqs)) (<span class="name"><span class="builtin-name">reduce</span></span> op init (<span class="name"><span class="builtin-name">map</span></span> first seqs)))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-237"><a class="markdownIt-Anchor" href="#exercise-237"></a> Exercise 2.37</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">dot-product</span> [v w] </span><br><span class="line">  (<span class="name"><span class="builtin-name">reduce</span></span> + <span class="number">0</span> (<span class="name"><span class="builtin-name">map</span></span> * v w)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">matrix-*-vector</span> [m v] </span><br><span class="line">  (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name">dot-product</span> % v) m))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">transpose</span> [m] </span><br><span class="line">  (<span class="name">accumulate-n</span> conj [] m))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">matrix*matrix</span> [m n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [cols (<span class="name">transpose</span> n)]</span><br><span class="line">    (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name">matrix-*-vector</span> cols %) m)))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-238"><a class="markdownIt-Anchor" href="#exercise-238"></a> Exercise 2.38</h4>
<p>Clojure only has fold-left, rather than fold-right.</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1/3</span><br><span class="line">3/2</span><br><span class="line">(<span class="number">1</span> (<span class="number">2</span> (<span class="number">3</span> <span class="literal">nil</span>)))</span><br><span class="line">(((<span class="name">nil</span> <span class="number">1</span>) <span class="number">2</span>) <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>The result of <code>fold-left</code> and <code>fold-right</code> are the same if and only if the associative law works for the function f.</p>
<h4 id="exercise-239"><a class="markdownIt-Anchor" href="#exercise-239"></a> Exercise 2.39</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">fold-left</span> reduce)</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">fold-right</span> [f init seq] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> seq) init (<span class="name">f</span> (<span class="name"><span class="builtin-name">first</span></span> seq) (<span class="name">fold-right</span> f init (<span class="name"><span class="builtin-name">rest</span></span> seq)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">reverse</span> [seq] (<span class="name">fold-right</span> #(<span class="name"><span class="builtin-name">conj</span></span> %<span class="number">2</span> %<span class="number">1</span>) [] seq))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">reverse</span> [seq] (<span class="name">fold-left</span> #(<span class="name"><span class="builtin-name">conj</span></span> %<span class="number">1</span> %<span class="number">2</span>) &#x27;() seq))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-240"><a class="markdownIt-Anchor" href="#exercise-240"></a> Exercise 2.40</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">unique-pairs</span> [n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">mapcat</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [i] (<span class="name"><span class="builtin-name">map</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [j] (<span class="name"><span class="builtin-name">list</span></span> i j)) (<span class="name"><span class="builtin-name">range</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">+</span></span> i <span class="number">1</span>)))) (<span class="name"><span class="builtin-name">range</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">+</span></span> n <span class="number">1</span>))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">prime?</span> [x] (<span class="name">every?</span> #(<span class="name"><span class="builtin-name">not=</span></span> (<span class="name"><span class="builtin-name">mod</span></span> x %) <span class="number">0</span>) (<span class="name"><span class="builtin-name">range</span></span> <span class="number">2</span> (<span class="name"><span class="builtin-name">+</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">int</span></span> (<span class="name">Math/sqrt</span> x))))))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">prime-sum-pairs</span> [n] (<span class="name"><span class="builtin-name">filter</span></span> #(<span class="name">prime?</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">first</span></span> %) (<span class="name"><span class="builtin-name">second</span></span> %))) (<span class="name">unique-pairs</span> n)))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-241"><a class="markdownIt-Anchor" href="#exercise-241"></a> Exercise 2.41</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">triples-e</span> [n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> (<span class="name">unique-pairs</span> n)</span><br><span class="line">       (<span class="name"><span class="builtin-name">filter</span></span> #(<span class="name"><span class="builtin-name">let</span></span> [a (<span class="name"><span class="builtin-name">second</span></span> %) b (<span class="name"><span class="builtin-name">first</span></span> %)] (<span class="name"><span class="builtin-name">&lt;</span></span> a b (<span class="name"><span class="builtin-name">-</span></span> n a b))))</span><br><span class="line">       (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name"><span class="builtin-name">let</span></span> [a (<span class="name"><span class="builtin-name">second</span></span> %) b (<span class="name"><span class="builtin-name">first</span></span> %)] (<span class="name"><span class="builtin-name">list</span></span> a b (<span class="name"><span class="builtin-name">-</span></span> n a b))))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">triples-le</span> [n] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">3</span>) () (<span class="name"><span class="builtin-name">concat</span></span> (<span class="name">triples-le</span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)) (<span class="name">triples-e</span> n))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-242"><a class="markdownIt-Anchor" href="#exercise-242"></a> Exercise 2.42</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">empty-board</span> ())</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">safe?</span> [k positions]</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [row-k (<span class="name"><span class="builtin-name">nth</span></span> positions (<span class="name"><span class="builtin-name">-</span></span> k <span class="number">1</span>)) diagonal-k-1 (<span class="name"><span class="builtin-name">+</span></span> k row-k) diagonal-k-2 (<span class="name"><span class="builtin-name">-</span></span> k row-k)]</span><br><span class="line">    (<span class="name">every?</span> (<span class="name"><span class="builtin-name">fn</span></span> [i] (<span class="name"><span class="builtin-name">let</span></span> [row-i (<span class="name"><span class="builtin-name">nth</span></span> positions (<span class="name"><span class="builtin-name">-</span></span> i <span class="number">1</span>)) diagonal-i-1 (<span class="name"><span class="builtin-name">+</span></span> i row-i) diagonal-i-2 (<span class="name"><span class="builtin-name">-</span></span> i row-i)]</span><br><span class="line">      (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">not=</span></span> row-i row-k) (<span class="name"><span class="builtin-name">not=</span></span> diagonal-i-1 diagonal-k-1) (<span class="name"><span class="builtin-name">not=</span></span> diagonal-i-2 diagonal-k-2)))) (<span class="name"><span class="builtin-name">range</span></span> <span class="number">1</span> k))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">adjoin-position</span> [new-row k rest-of-queens] </span><br><span class="line">  (<span class="name"><span class="builtin-name">concat</span></span> rest-of-queens (<span class="name"><span class="builtin-name">list</span></span> new-row)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">queens</span> [board-size]</span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">queen-cols</span> [k] </span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> k <span class="number">0</span>) (<span class="name"><span class="builtin-name">list</span></span> empty-board)</span><br><span class="line">                (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> (<span class="name">queen-cols</span> (<span class="name"><span class="builtin-name">-</span></span> k <span class="number">1</span>))</span><br><span class="line">                     (<span class="name"><span class="builtin-name">mapcat</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [rest-of-queens] (<span class="name"><span class="builtin-name">map</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [new-row] (<span class="name">adjoin-position</span> new-row k rest-of-queens)) (<span class="name"><span class="builtin-name">range</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">+</span></span> board-size <span class="number">1</span>)))))</span><br><span class="line">                     (<span class="name"><span class="builtin-name">filter</span></span> (<span class="name"><span class="builtin-name">partial</span></span> safe? k)))))</span><br><span class="line">  (<span class="name">queen-cols</span> board-size))</span><br></pre></td></tr></table></figure>
<p>Another version (the search algorithm), works in the positive order.</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">(<span class="keyword">defn</span> <span class="title">queens-optimized</span> [board-size] </span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">safe?</span> [used-diagonal-1 used-diagonal-2 cur]</span><br><span class="line">    (<span class="name"><span class="builtin-name">let</span></span> [new-row (<span class="name"><span class="builtin-name">last</span></span> cur) new-col (<span class="name"><span class="builtin-name">count</span></span> cur)]</span><br><span class="line">      (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name">used-diagonal-1</span> (<span class="name"><span class="builtin-name">+</span></span> new-row new-col <span class="number">-2</span>)) (<span class="name">used-diagonal-2</span> (<span class="name"><span class="builtin-name">+</span></span> new-row (<span class="name"><span class="builtin-name">-</span></span> new-col) board-size <span class="number">-1</span>))))))</span><br><span class="line"></span><br><span class="line">  <span class="comment">; used-diagonal-1: [0, 2n-2],  used-diagonal-2: [0, 2n-2], unused: [1, n]</span></span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">generate-state</span> [used-diagonal-1 used-diagonal-2 unused cur]</span><br><span class="line">    (<span class="name"><span class="builtin-name">let</span></span> [new-row (<span class="name"><span class="builtin-name">last</span></span> cur) new-col (<span class="name"><span class="builtin-name">count</span></span> cur)]</span><br><span class="line">      (<span class="name"><span class="builtin-name">list</span></span> (<span class="name"><span class="builtin-name">assoc</span></span> used-diagonal-1 (<span class="name"><span class="builtin-name">+</span></span> new-row new-col <span class="number">-2</span>) <span class="literal">true</span>)</span><br><span class="line">            (<span class="name"><span class="builtin-name">assoc</span></span> used-diagonal-2 (<span class="name"><span class="builtin-name">+</span></span> new-row (<span class="name"><span class="builtin-name">-</span></span> new-col) board-size <span class="number">-1</span>) <span class="literal">true</span>)</span><br><span class="line">            (<span class="name"><span class="builtin-name">disj</span></span> unused new-row)</span><br><span class="line">            cur)))</span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">permutation</span> [used-diagonal-1 used-diagonal-2 unused cur]</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> unused) (<span class="name"><span class="builtin-name">list</span></span> cur)</span><br><span class="line">                        (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> unused</span><br><span class="line">                             (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name"><span class="builtin-name">conj</span></span> cur %)) </span><br><span class="line">                             (<span class="name"><span class="builtin-name">filter</span></span> (<span class="name"><span class="builtin-name">partial</span></span> safe? used-diagonal-1 used-diagonal-2))</span><br><span class="line">                             (<span class="name"><span class="builtin-name">mapcat</span></span> #(<span class="name"><span class="builtin-name">apply</span></span> permutation (<span class="name">generate-state</span> used-diagonal-1 used-diagonal-2 unused %)))</span><br><span class="line">                        )))</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [initial-diagonal (<span class="name"><span class="builtin-name">vec</span></span> (<span class="name"><span class="builtin-name">repeat</span></span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">*</span></span> <span class="number">2</span> board-size) <span class="number">1</span>) <span class="literal">false</span>))]</span><br><span class="line">    (<span class="name">permutation</span> initial-diagonal initial-diagonal (<span class="name">set</span> (<span class="name"><span class="builtin-name">range</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">+</span></span> board-size <span class="number">1</span>))) [])))</span><br></pre></td></tr></table></figure>
<p>It’s slower because:</p>
<ol>
<li>
<p>The search algorithm wants the state to be transfered between function calls.</p>
</li>
<li>
<p>The search algorithm forms a tree of call stacks, while the recursive algorithm only forms a chain of call stacks.</p>
</li>
</ol>
<p>So here you mihght see that pure recursive algorithm works better for this particular problem.</p>
<h4 id="exercise-243"><a class="markdownIt-Anchor" href="#exercise-243"></a> Exercise 2.43</h4>
<p>Interchanging the order of maping cause the call stacks form a tree, i.e. every <code>queen-cols</code> functions calls itself at least once(In the beginning it’s n times.</p>
<p>Estimates:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∵</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>4</mn></mrow><mi>n</mi></munderover><mfrac><msup><mi>i</mi><mn>2</mn></msup><mrow><mi>i</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></mfrac><mtext> converges.</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>∴</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mi>i</mi><mn>2</mn></msup><mfrac><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><mrow><mi>i</mi><mo stretchy="false">!</mo></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>4</mn></mrow><mi>n</mi></munderover><mfrac><msup><mi>i</mi><mn>2</mn></msup><mrow><mi>i</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mtext>, where </mtext><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>f</mi><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>T</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mi>n</mi></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin {aligned}
&amp;\because&amp; \sum_{i=4}^n \frac{i^2}{i(i-1)(i-2)(i-3)} \text{ converges.}\\
&amp;\therefore&amp; T(n)=O( \sum_{i=1}^n i^2 \frac {n!}{i!}) = O(n!\sum_{i=4}^n \frac{i^2}{i(i-1)(i-2)(i-3)}) = O(n!)\\
&amp;&amp;T&#x27;(n)=f(n)\text{, where }f(i) = O(n f(i-1)), f(0) = O(1) \\
&amp;&amp;T&#x27;(n)=O(n^n) \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.458132em;vertical-align:-4.479066em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.979066em;"><span style="top:-6.979066em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"></span></span><span style="top:-3.75em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"></span></span><span style="top:-1.332331em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"></span></span><span style="top:0.16766900000000007em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.479066em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.979066em;"><span style="top:-6.979066em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∵</span></span></span><span style="top:-3.75em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">∴</span></span></span><span style="top:-1.332331em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span></span></span><span style="top:0.16766900000000007em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.479066em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.979066em;"><span style="top:-6.979066em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">4</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord text"><span class="mord"> converges.</span></span></span></span><span style="top:-3.75em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="mclose">!</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">4</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">!</span><span class="mclose">)</span></span></span><span style="top:-1.332331em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mord text"><span class="mord">, where </span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:0.16766900000000007em;"><span class="pstrut" style="height:3.6513970000000002em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.479066em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>Calculating the actual time difference its meaningless most of the time, since there is always a constant factor in <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Big_O_notation">Big O notation</a>.</p>
<p>(Also I’m lazy :p)</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">empty-board</span> ())</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">safe?</span> [k positions]</span><br><span class="line">      (and (not= row-i row-k) (not= diagonal-i-1 diagonal-k-1) (not= diagonal-i-2 diagonal-k-2)))) (range 1 k))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">adjoin-position</span> [new-row k rest-of-queens] </span><br><span class="line">  (<span class="name"><span class="builtin-name">concat</span></span> rest-of-queens (<span class="name"><span class="builtin-name">list</span></span> new-row)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">queens</span> [board-size]</span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">queen-cols</span> [k] </span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> k <span class="number">0</span>) (<span class="name"><span class="builtin-name">list</span></span> empty-board)</span><br><span class="line">                (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> (<span class="name">queen-cols</span> (<span class="name"><span class="builtin-name">-</span></span> k <span class="number">1</span>))</span><br><span class="line">                     (<span class="name"><span class="builtin-name">mapcat</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [rest-of-queens] (<span class="name"><span class="builtin-name">map</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [new-row] (<span class="name">adjoin-position</span> new-row k rest-of-queens)) (<span class="name"><span class="builtin-name">range</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">+</span></span> board-size <span class="number">1</span>)))))</span><br><span class="line">                     (<span class="name"><span class="builtin-name">filter</span></span> (<span class="name"><span class="builtin-name">partial</span></span> safe? k)))))</span><br><span class="line">  (<span class="name">queen-cols</span> board-size))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">bad-queens</span> [board-size]</span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">queen-cols</span> [k] </span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> k <span class="number">0</span>) (<span class="name"><span class="builtin-name">list</span></span> empty-board)</span><br><span class="line">                (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> (<span class="name"><span class="builtin-name">range</span></span> <span class="number">1</span> (<span class="name"><span class="builtin-name">+</span></span> board-size <span class="number">1</span>))</span><br><span class="line">                     (<span class="name"><span class="builtin-name">mapcat</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [new-row] (<span class="name"><span class="builtin-name">map</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [rest-of-queens] (<span class="name">adjoin-position</span> new-row k rest-of-queens)) (<span class="name">queen-cols</span> (<span class="name"><span class="builtin-name">-</span></span> k <span class="number">1</span>)))))</span><br><span class="line">                     (<span class="name"><span class="builtin-name">filter</span></span> (<span class="name"><span class="builtin-name">partial</span></span> safe? k)))))</span><br><span class="line">  (<span class="name">queen-cols</span> board-size))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">time</span></span> (<span class="name">queens</span> <span class="number">8</span>))<span class="comment">; &quot;Elapsed time: 18.970709 msecs&quot;</span></span><br><span class="line">(<span class="name"><span class="builtin-name">time</span></span> (<span class="name">bad-queens</span> <span class="number">8</span>))<span class="comment">; &quot;Elapsed time: 2977.498625 msecs&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="exercise-244"><a class="markdownIt-Anchor" href="#exercise-244"></a> Exercise 2.44</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">up-split</span> [painter n] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) painter </span><br><span class="line">    (<span class="name"><span class="builtin-name">let</span></span> [smaller (<span class="name">up-split</span> painter (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>))]</span><br><span class="line">      (<span class="name">below</span> painter (<span class="name">beside</span> smaller smaller)))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-245"><a class="markdownIt-Anchor" href="#exercise-245"></a> Exercise 2.45</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">split</span> [painter n op1 op2] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) painter </span><br><span class="line">    (<span class="name"><span class="builtin-name">let</span></span> [smaller (<span class="name">split</span> painter (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>) op1 op2)]</span><br><span class="line">      (<span class="name">op1</span> painter (<span class="name">op2</span> smaller smaller)))))</span><br><span class="line">      </span><br><span class="line">(<span class="keyword">def</span> <span class="title">right-split</span> beside below)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">up-split</span> below beside)</span><br></pre></td></tr></table></figure>
<h4 id="exercise-246"><a class="markdownIt-Anchor" href="#exercise-246"></a> Exercise 2.46</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">make-vect</span> vector)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">xcor-vect</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">ycor-vect</span> second)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">add-vect</span> [v1 v2] (<span class="name">make-vect</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">xcor-vect</span> v1) (<span class="name">xcor-vect</span> v2)) (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">ycor-vect</span> v1) (<span class="name">ycor-vect</span> v2))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">sub-vect</span> [v1 v2] (<span class="name">make-vect</span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">xcor-vect</span> v1) (<span class="name">xcor-vect</span> v2)) (<span class="name"><span class="builtin-name">-</span></span> (<span class="name">ycor-vect</span> v1) (<span class="name">ycor-vect</span> v2))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">scale-vect</span> [s v] (<span class="name">make-vect</span> (<span class="name"><span class="builtin-name">*</span></span> s (<span class="name">xcor-vect</span> v)) (<span class="name"><span class="builtin-name">*</span></span> s (<span class="name">ycor-vect</span> v))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-247"><a class="markdownIt-Anchor" href="#exercise-247"></a> Exercise 2.47</h4>
<p>Clojure doesn’t have the same <code>cons</code> as Scheme does.</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">make-frame</span> [origin edge1 edge2]</span><br><span class="line">  (<span class="name"><span class="builtin-name">list</span></span> origin edge1 edge2))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">origin-frame</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">edge1-frame</span> second)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">edge2-frame</span> last)</span><br></pre></td></tr></table></figure>
<h4 id="exercise-248"><a class="markdownIt-Anchor" href="#exercise-248"></a> Exercise 2.48</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">make-segment</span> list)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">start-segment</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">end-segment</span> second)</span><br></pre></td></tr></table></figure>
<h4 id="exercise-249"><a class="markdownIt-Anchor" href="#exercise-249"></a> Exercise 2.49</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">frame-coord-map</span> [frame] </span><br><span class="line">  (<span class="name"><span class="builtin-name">fn</span></span> [v] (<span class="name">add-vect</span> (<span class="name">origin-frame</span> frame) </span><br><span class="line">          (<span class="name">add-vect</span> (<span class="name">scale-vect</span> (<span class="name">xcor-vect</span> v) (<span class="name">edge1-frame</span> frame))</span><br><span class="line">                    (<span class="name">scale-vect</span> (<span class="name">ycor-vect</span> v) (<span class="name">edge2-frame</span> frame))))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">segments-&gt;painter</span> [segments]</span><br><span class="line">  (<span class="name"><span class="builtin-name">fn</span></span> [frame] </span><br><span class="line">    (<span class="name"><span class="builtin-name">doseq</span></span> [segment segments]</span><br><span class="line">      (<span class="name">draw-line</span> ((<span class="name">frame-coord-map</span> frame) (<span class="name">start-segment</span> segment)) ((<span class="name">frame-coord-map</span> frame) (<span class="name">end-segment</span> segment))))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">shape</span> [point-list]</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [cnt (<span class="name"><span class="builtin-name">count</span></span> point-list)]</span><br><span class="line">    (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name">make-segment</span> (<span class="name"><span class="builtin-name">nth</span></span> point-list %) (<span class="name"><span class="builtin-name">nth</span></span> point-list (<span class="name"><span class="builtin-name">mod</span></span> (<span class="name"><span class="builtin-name">+</span></span> % <span class="number">1</span>) cnt))) (<span class="name"><span class="builtin-name">range</span></span> cnt))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">comp-painter</span> [painters]</span><br><span class="line">  (<span class="name"><span class="builtin-name">fn</span></span> [frame] (<span class="name"><span class="builtin-name">doseq</span></span> [p painters] (<span class="name">p</span> frame))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">outline</span> (<span class="name">shape</span> (<span class="name"><span class="builtin-name">list</span></span> (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">0</span>) (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">1</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">1</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">0</span>))))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">X</span> (<span class="name"><span class="builtin-name">list</span></span> (<span class="name">make-segment</span> (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">0</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">1</span>)) (<span class="name">make-segment</span> (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">1</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">0</span>))))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">diamond</span> (<span class="name">shape</span> (<span class="name"><span class="builtin-name">list</span></span> (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">1</span>/<span class="number">2</span>) (<span class="name">make-vect</span> <span class="number">1</span>/<span class="number">2</span> <span class="number">1</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">1</span>/<span class="number">2</span>) (<span class="name">make-vect</span> <span class="number">1</span>/<span class="number">2</span> <span class="number">0</span>))))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">wave</span> (<span class="name">shape</span> (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name"><span class="builtin-name">apply</span></span> make-vect %) &#x27;(</span><br><span class="line">  (<span class="number">1</span>/<span class="number">3</span> <span class="number">1</span>) (<span class="number">2</span>/<span class="number">3</span> <span class="number">1</span>) (<span class="number">11</span>/<span class="number">14</span> <span class="number">5</span>/<span class="number">6</span>) (<span class="number">2</span>/<span class="number">3</span> <span class="number">2</span>/<span class="number">3</span>) (<span class="number">2</span>/<span class="number">3</span> <span class="number">7</span>/<span class="number">12</span>) (<span class="number">11</span>/<span class="number">14</span> <span class="number">7</span>/<span class="number">12</span>) (<span class="number">1</span> <span class="number">5</span>/<span class="number">12</span>) (<span class="number">1</span> <span class="number">1</span>/<span class="number">3</span>) (<span class="number">2</span>/<span class="number">3</span> <span class="number">1</span>/<span class="number">2</span>) (<span class="number">2</span>/<span class="number">3</span> <span class="number">1</span>/<span class="number">3</span>) (<span class="number">11</span>/<span class="number">14</span> <span class="number">0</span>) (<span class="number">2</span>/<span class="number">3</span> <span class="number">0</span>) (<span class="number">1</span>/<span class="number">2</span> <span class="number">1</span>/<span class="number">4</span>) (<span class="number">1</span>/<span class="number">3</span> <span class="number">0</span>) (<span class="number">1</span>/<span class="number">3</span> <span class="number">5</span>/<span class="number">12</span>) (<span class="number">3</span>/<span class="number">28</span> <span class="number">1</span>/<span class="number">3</span>) (<span class="number">0</span> <span class="number">2</span>/<span class="number">3</span>) (<span class="number">0</span> <span class="number">5</span>/<span class="number">6</span>) (<span class="number">3</span>/<span class="number">28</span> <span class="number">7</span>/<span class="number">12</span>) (<span class="number">1</span>/<span class="number">3</span> <span class="number">2</span>/<span class="number">3</span>) (<span class="number">3</span>/<span class="number">14</span> <span class="number">5</span>/<span class="number">6</span>)</span><br><span class="line">))))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">smile</span> (<span class="name">shape</span> (<span class="name"><span class="builtin-name">list</span></span> (<span class="name">make-vect</span> <span class="number">5</span>/<span class="number">12</span> <span class="number">5</span>/<span class="number">6</span>) (<span class="name">make-vect</span> <span class="number">1</span>/<span class="number">2</span> <span class="number">3</span>/<span class="number">4</span>) (<span class="name">make-vect</span> <span class="number">7</span>/<span class="number">12</span> <span class="number">5</span>/<span class="number">6</span>))))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">figures</span> &#123;<span class="symbol">:outline</span> outline, <span class="symbol">:X</span> X, <span class="symbol">:diamond</span> diamond <span class="symbol">:wave</span> wave <span class="symbol">:smile</span> smile&#125;)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">painter-figures</span> (<span class="name"><span class="builtin-name">into</span></span> &#123;&#125; (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name"><span class="builtin-name">vector</span></span> (<span class="name"><span class="builtin-name">first</span></span> %) (<span class="name">segments-&gt;painter</span> (<span class="name"><span class="builtin-name">second</span></span> %))) figures)))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-250"><a class="markdownIt-Anchor" href="#exercise-250"></a> Exercise 2.50</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">flip-horiz</span> [painter]</span><br><span class="line">  (<span class="name">transform-painter</span> painter (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">0</span>) (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">0</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">rotate90</span> [painter]</span><br><span class="line">  (<span class="name">transform-painter</span> painter (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">0</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">1</span>) (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">0</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">rotate180</span> [painter]</span><br><span class="line">  (<span class="name">transform-painter</span> painter (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">1</span>) (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">1</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">0</span>)))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-251"><a class="markdownIt-Anchor" href="#exercise-251"></a> Exercise 2.51</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">rotate90</span> [painter]</span><br><span class="line">  (<span class="name">transform-painter</span> painter (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">0</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">1</span>) (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">0</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">beside</span> </span><br><span class="line">  ([painter] (<span class="name">beside</span> painter painter))</span><br><span class="line">  ([painter1 painter2]</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [split-point (<span class="name">make-vect</span> <span class="number">1</span>/<span class="number">2</span> <span class="number">0</span>)</span><br><span class="line">        paint-left (<span class="name">transform-painter</span> painter1 (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">0</span>) split-point (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">1</span>))</span><br><span class="line">        paint-right (<span class="name">transform-painter</span> painter2 split-point (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">0</span>) (<span class="name">make-vect</span> <span class="number">1</span>/<span class="number">2</span> <span class="number">1</span>))]</span><br><span class="line">    (<span class="name"><span class="builtin-name">fn</span></span> [frame] (<span class="name">paint-left</span> frame) (<span class="name">paint-right</span> frame)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">below</span> </span><br><span class="line">  ([painter] (<span class="name">below</span> painter painter))</span><br><span class="line">  ([painter1 painter2]</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [split-point (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">1</span>/<span class="number">2</span>)</span><br><span class="line">        paint-up (<span class="name">transform-painter</span> painter1 split-point (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">1</span>/<span class="number">2</span>) (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">1</span>))</span><br><span class="line">        paint-down (<span class="name">transform-painter</span> painter2 (<span class="name">make-vect</span> <span class="number">0</span> <span class="number">0</span>) (<span class="name">make-vect</span> <span class="number">1</span> <span class="number">0</span>) split-point)]</span><br><span class="line">    (<span class="name"><span class="builtin-name">fn</span></span> [frame] (<span class="name">paint-up</span> frame) (<span class="name">paint-down</span> frame)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">below2</span> [painter1 painter2]</span><br><span class="line">  (<span class="name">rotate270</span> (<span class="name">beside</span> (<span class="name">rotate90</span> painter1) (<span class="name">rotate90</span> painter2))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-252"><a class="markdownIt-Anchor" href="#exercise-252"></a> Exercise 2.52</h4>
<p>I use quil on clojure to implement everything of Chapter 2.2.4 on <a target="_blank" rel="noopener" href="https://github.com/glyh/sicp-solutions-clojure/blob/main/src/sicp_solutions_clojure/chapter_2/picture_language.clj">Github</a>.</p>
<h4 id="exercise-253"><a class="markdownIt-Anchor" href="#exercise-253"></a> Exercise 2.53</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">list</span></span> &#x27;a &#x27;b &#x27;c)<span class="comment">; =&gt; (a b c)</span></span><br><span class="line">(<span class="name"><span class="builtin-name">list</span></span> (<span class="name"><span class="builtin-name">list</span></span> &#x27;george))<span class="comment">; =&gt; ((george))</span></span><br><span class="line">(<span class="name">cdr</span> &#x27;((<span class="name">x1</span> x2) (<span class="name">y1</span> y2)))<span class="comment">; =&gt; (y1 y2)</span></span><br><span class="line">(<span class="name">cadr</span> &#x27;((<span class="name">x1</span> x2) (<span class="name">y1</span> y2)))<span class="comment">; =&gt; y1</span></span><br><span class="line">(<span class="name">pair?</span> (<span class="name">car</span> &#x27;(<span class="name">a</span> short list)))<span class="comment">; =&gt; false</span></span><br><span class="line">(<span class="name">memq</span> &#x27;red &#x27;((<span class="name">red</span> shoes) (<span class="name">blue</span> socks)))<span class="comment">; =&gt; false</span></span><br><span class="line">(<span class="name">memq</span> &#x27;red &#x27;(<span class="name">red</span> shoes blue socks))<span class="comment">; =&gt; true</span></span><br></pre></td></tr></table></figure>
<h4 id="exercise-254"><a class="markdownIt-Anchor" href="#exercise-254"></a> Exercise 2.54</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">equal-list</span> [a b]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">list?</span></span> a) (<span class="name"><span class="builtin-name">list?</span></span> b)) </span><br><span class="line">          (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> a) (<span class="name"><span class="builtin-name">empty?</span></span> b)) <span class="literal">true</span></span><br><span class="line">                (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> a) (<span class="name"><span class="builtin-name">empty?</span></span> b))) (<span class="name"><span class="builtin-name">and</span></span> (<span class="name">equal-list</span> (<span class="name"><span class="builtin-name">first</span></span> a) (<span class="name"><span class="builtin-name">first</span></span> b)) (<span class="name"><span class="builtin-name">recur</span></span> (<span class="name"><span class="builtin-name">rest</span></span> a) (<span class="name"><span class="builtin-name">rest</span></span> b)))</span><br><span class="line">                <span class="symbol">:else</span> <span class="literal">false</span>)</span><br><span class="line">        (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">list?</span></span> a) (<span class="name"><span class="builtin-name">list?</span></span> b))) (<span class="name"><span class="builtin-name">=</span></span> a b)</span><br><span class="line">        <span class="symbol">:else</span> <span class="literal">false</span>))</span><br></pre></td></tr></table></figure>
<p>Actually a single <code>=</code> will do all the jobs for us.</p>
<h4 id="exercise-255"><a class="markdownIt-Anchor" href="#exercise-255"></a> Exercise 2.55</h4>
<p><code>'</code> is but a macro. The reader of clojure will translate <code>''abracadabra</code> into <code>(quote (quote abracadabra))</code>.</p>
<p>As a result, you’ll get <code>(quote abracadabra)</code>.</p>
<h4 id="exercise-256"><a class="markdownIt-Anchor" href="#exercise-256"></a> Exercise 2.56</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">variable?</span> symbol?)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">same-variable?</span> =)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-sum</span> [a1 a2] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">=</span></span> a1 <span class="number">0</span>) a2 </span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> a2 <span class="number">0</span>) a1</span><br><span class="line">        (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">number?</span></span> a1) (<span class="name"><span class="builtin-name">number?</span></span> a2)) (<span class="name"><span class="builtin-name">+</span></span> a1 a2)</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">list</span></span> &#x27;+ a1 a2)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-product</span> [a1 a2] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">=</span></span> a1 <span class="number">0</span>) (<span class="name"><span class="builtin-name">=</span></span> a2 <span class="number">0</span>)) <span class="number">0</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> a1 <span class="number">1</span>) a2</span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> a2 <span class="number">1</span>) a1</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">list</span></span> &#x27;* a1 a2)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-exponentiation</span> [u n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) (<span class="name"><span class="builtin-name">=</span></span> u <span class="number">1</span>)) <span class="number">1</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">1</span>) u</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">list</span></span> &#x27;** u n)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">addend</span> second)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">augend</span> last)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">multiplier</span> second)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">multiplicand</span> last)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">base</span> second)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">exponent</span> last)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">sum?</span> [x] (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">list?</span></span> x) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> x) &#x27;+)))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">product?</span> [x] (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">list?</span></span> x) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> x) &#x27;*)))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">exponentiation?</span> [x] (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">list?</span></span> x) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> x) &#x27;**)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">deriv</span> [exp var] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">number?</span></span> exp) <span class="number">0</span></span><br><span class="line">        (<span class="name">variable?</span> exp) (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> exp var) <span class="number">1</span> <span class="number">0</span>)</span><br><span class="line">        (<span class="name">sum?</span> exp) (<span class="name">make-sum</span> (<span class="name">deriv</span> (<span class="name">addend</span> exp) var) (<span class="name">deriv</span> (<span class="name">augend</span> exp) var))</span><br><span class="line">        (<span class="name">product?</span> exp) (<span class="name">make-sum</span> (<span class="name">make-product</span> (<span class="name">deriv</span> (<span class="name">multiplier</span> exp) var) (<span class="name">multiplicand</span> exp)) (<span class="name">make-product</span> (<span class="name">deriv</span> (<span class="name">multiplicand</span> exp) var) (<span class="name">multiplier</span> exp)))</span><br><span class="line">        (<span class="name">exponentiation?</span> exp) (<span class="name">make-product</span> (<span class="name">make-product</span> (<span class="name">exponent</span> exp) (<span class="name">make-exponentiation</span> (<span class="name">base</span> exp) (<span class="name">make-sum</span> (<span class="name">exponent</span> exp) <span class="number">-1</span>))) (<span class="name">deriv</span> (<span class="name">base</span> exp) var))</span><br><span class="line">         <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">throw</span></span> (<span class="name">Exception.</span> (<span class="name"><span class="builtin-name">str</span></span> <span class="string">&quot;unknown expression type: DERIV&quot;</span> exp)))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-257"><a class="markdownIt-Anchor" href="#exercise-257"></a> Exercise 2.57</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">variable?</span> symbol?)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">same-variable?</span> =)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-sum</span> [&amp; args] </span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">insert-into-sum</span> [col i]</span><br><span class="line">    (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">number?</span></span> i) (<span class="name"><span class="builtin-name">assoc</span></span> col <span class="number">0</span> (<span class="name"><span class="builtin-name">+</span></span> (<span class="name"><span class="builtin-name">first</span></span> col) i))</span><br><span class="line">          <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">conj</span></span> col i)))</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [simplified (<span class="name"><span class="builtin-name">reduce</span></span> insert-into-sum [<span class="number">0</span>] args)]</span><br><span class="line">    (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">count</span></span> simplified) <span class="number">1</span>) (<span class="name"><span class="builtin-name">first</span></span> simplified)</span><br><span class="line">          (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">count</span></span> simplified) <span class="number">2</span>) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> simplified) <span class="number">0</span>)) (<span class="name"><span class="builtin-name">second</span></span> simplified)</span><br><span class="line">          <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">vec</span></span> (<span class="name"><span class="builtin-name">concat</span></span> &#x27;[+] (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> simplified) <span class="number">0</span>) (<span class="name"><span class="builtin-name">rest</span></span> simplified) simplified))))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-product</span> [&amp; args]</span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">insert-into-product</span> [col i]</span><br><span class="line">    (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">number?</span></span> i) (<span class="name"><span class="builtin-name">assoc</span></span> col <span class="number">0</span> (<span class="name"><span class="builtin-name">*</span></span> (<span class="name"><span class="builtin-name">first</span></span> col) i))</span><br><span class="line">          <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">conj</span></span> col i)))</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">some</span> #(<span class="name"><span class="builtin-name">=</span></span> % <span class="number">0</span>) args) <span class="number">0</span></span><br><span class="line">    (<span class="name"><span class="builtin-name">let</span></span> [simplified (<span class="name"><span class="builtin-name">reduce</span></span> insert-into-product [<span class="number">1</span>] args)]</span><br><span class="line">      (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">count</span></span> simplified) <span class="number">1</span>) (<span class="name"><span class="builtin-name">first</span></span> simplified)</span><br><span class="line">            (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">count</span></span> simplified) <span class="number">2</span>) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> simplified) <span class="number">1</span>)) (<span class="name"><span class="builtin-name">second</span></span> simplified)</span><br><span class="line">            <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">vec</span></span> (<span class="name"><span class="builtin-name">concat</span></span> &#x27;[*] (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> simplified) <span class="number">1</span>) (<span class="name"><span class="builtin-name">rest</span></span> simplified) simplified)))))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-exponentiation</span> [u n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) (<span class="name"><span class="builtin-name">=</span></span> u <span class="number">1</span>)) <span class="number">1</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">1</span>) u</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">vector</span></span> &#x27;** u n)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">base</span> second)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">exponent</span> last)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">sum?</span> [x] (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">list?</span></span> x) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> x) &#x27;+)))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">product?</span> [x] (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">list?</span></span> x) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> x) &#x27;*)))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">exponentiation?</span> [x] (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">list?</span></span> x) (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> x) &#x27;**)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">deriv-nth-product</span> [col var id]</span><br><span class="line">  (<span class="name"><span class="builtin-name">apply</span></span> make-product (<span class="name">map-indexed</span> (<span class="name"><span class="builtin-name">fn</span></span> [id&#x27; item] (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> id&#x27; id) (<span class="name">deriv</span> item var) item)) col)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">deriv</span> [exp var] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">number?</span></span> exp) <span class="number">0</span></span><br><span class="line">        (<span class="name">variable?</span> exp) (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> exp var) <span class="number">1</span> <span class="number">0</span>)</span><br><span class="line">        (<span class="name">sum?</span> exp) (<span class="name"><span class="builtin-name">apply</span></span> make-sum (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name">deriv</span> % var) (<span class="name"><span class="builtin-name">rest</span></span> exp)))</span><br><span class="line">        (<span class="name">product?</span> exp) </span><br><span class="line">          (<span class="name"><span class="builtin-name">let</span></span> [n (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">count</span></span> exp) <span class="number">1</span>)]</span><br><span class="line">            (<span class="name"><span class="builtin-name">apply</span></span> make-sum (<span class="name"><span class="builtin-name">map</span></span> (<span class="name"><span class="builtin-name">partial</span></span> deriv-nth-product (<span class="name"><span class="builtin-name">rest</span></span> exp) var) (<span class="name"><span class="builtin-name">range</span></span> (<span class="name"><span class="builtin-name">-</span></span> (<span class="name"><span class="builtin-name">count</span></span> exp) <span class="number">1</span>)))))</span><br><span class="line">        (<span class="name">exponentiation?</span> exp) (<span class="name">make-product</span> (<span class="name">make-product</span> (<span class="name">exponent</span> exp) (<span class="name">make-exponentiation</span> (<span class="name">base</span> exp) (<span class="name">make-sum</span> (<span class="name">exponent</span> exp) <span class="number">-1</span>))) (<span class="name">deriv</span> (<span class="name">base</span> exp) var))</span><br><span class="line">         <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">throw</span></span> (<span class="name">Exception.</span> (<span class="name"><span class="builtin-name">str</span></span> <span class="string">&quot;unknown expression type: DERIV&quot;</span> exp)))))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>I’ve changed the definition of <code>deriv</code> here.</p>
<p>You can also do it without changing the definition of <code>deriv</code>, just change <code>augend</code> and <code>multiplicand</code> to these:</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">drop-nth</span> [n coll]</span><br><span class="line">   (<span class="name">keep-indexed</span> #(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">not=</span></span> %<span class="number">1</span> n) %<span class="number">2</span>) coll))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">augend</span> [exp]</span><br><span class="line">  (<span class="name">drop-nth</span> <span class="number">1</span> exp))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">multiplicand</span> [exp]</span><br><span class="line">  (<span class="name">drop-nth</span> <span class="number">1</span> exp))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-258"><a class="markdownIt-Anchor" href="#exercise-258"></a> Exercise 2.58</h4>
<h5 id="1"><a class="markdownIt-Anchor" href="#1"></a> 1)</h5>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">infix-&gt;prefix</span> [exp]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">number?</span></span> exp) (<span class="name">variable?</span> exp)) exp</span><br><span class="line">    (<span class="name"><span class="builtin-name">vector</span></span> (<span class="name"><span class="builtin-name">second</span></span> exp) (<span class="name">infix-&gt;prefix</span> (<span class="name"><span class="builtin-name">first</span></span> exp)) (<span class="name">infix-&gt;prefix</span> (<span class="name"><span class="builtin-name">last</span></span> exp)))))</span><br></pre></td></tr></table></figure>
<h5 id="2"><a class="markdownIt-Anchor" href="#2"></a> 2)</h5>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">operators-precedence</span> &#123;&#x27;+ <span class="number">1</span>, &#x27;* <span class="number">2</span>, &#x27;** <span class="number">3</span>&#125;)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">add-parentheses-to-prefix</span> [exp] <span class="comment">; Only works for binary operators</span></span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">number?</span></span> exp) (<span class="name">variable?</span> exp)) exp</span><br><span class="line">    (<span class="name"><span class="builtin-name">let</span></span> [sorted-ops (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> exp</span><br><span class="line">         (<span class="name">map-indexed</span> (<span class="name"><span class="builtin-name">fn</span></span> [idx itm] (<span class="name"><span class="builtin-name">list</span></span> idx (<span class="name"><span class="builtin-name">get</span></span> operators-precedence itm))))</span><br><span class="line">         (<span class="name"><span class="builtin-name">filter</span></span> #(<span class="name"><span class="builtin-name">not=</span></span> (<span class="name"><span class="builtin-name">second</span></span> %) <span class="literal">nil</span>))</span><br><span class="line">         (<span class="name"><span class="builtin-name">sort-by</span></span> second)) split-at (<span class="name"><span class="builtin-name">first</span></span> (<span class="name"><span class="builtin-name">first</span></span> sorted-ops))] </span><br><span class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">nil?</span></span> split-at) (<span class="name"><span class="builtin-name">recur</span></span> (<span class="name"><span class="builtin-name">first</span></span> exp))<span class="comment">; the expression is a constant in some brackets</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">vector</span></span> (<span class="name"><span class="builtin-name">nth</span></span> exp split-at) (<span class="name">add-parentheses-to-prefix</span> (<span class="name"><span class="builtin-name">take</span></span> split-at exp)) (<span class="name">add-parentheses-to-prefix</span> (<span class="name"><span class="builtin-name">drop</span></span> (<span class="name"><span class="builtin-name">+</span></span> split-at <span class="number">1</span>) exp)))))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-259"><a class="markdownIt-Anchor" href="#exercise-259"></a> Exercise 2.59</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">element-of-set?</span> [x set]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> x (<span class="name"><span class="builtin-name">first</span></span> set)) <span class="literal">true</span></span><br><span class="line">      (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> set)) (<span class="name"><span class="builtin-name">recur</span></span> x (<span class="name"><span class="builtin-name">rest</span></span> set)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">adjoin-set</span> [x set] </span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">element-of-set?</span> x set) set (<span class="name"><span class="builtin-name">conj</span></span> set x)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">union-set</span> [s1 s2] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> s1) s2 </span><br><span class="line">        (<span class="name"><span class="builtin-name">empty?</span></span> s2) s1</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name">adjoin-set</span> (<span class="name"><span class="builtin-name">first</span></span> s1) (<span class="name">union-set</span> (<span class="name"><span class="builtin-name">rest</span></span> s1) s2))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-260"><a class="markdownIt-Anchor" href="#exercise-260"></a> Exercise 2.60</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">element-of-set?</span> [x set]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> x (<span class="name"><span class="builtin-name">first</span></span> set)) <span class="literal">true</span></span><br><span class="line">      (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> set)) (<span class="name"><span class="builtin-name">recur</span></span> x (<span class="name"><span class="builtin-name">rest</span></span> set)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">ajoin-set</span> conj)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">union-set</span> concat)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">intersection-set</span> [s1 s2] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> s1) (<span class="name"><span class="builtin-name">empty?</span></span> s2)) ()</span><br><span class="line">        (<span class="name">element-of-set?</span> (<span class="name"><span class="builtin-name">first</span></span> s1) s2) (<span class="name">adjoin-set</span> (<span class="name">intersection-set</span> (<span class="name"><span class="builtin-name">rest</span></span> s1) s2) (<span class="name"><span class="builtin-name">first</span></span> s1))</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">recur</span></span> (<span class="name"><span class="builtin-name">rest</span></span> s1) s2)))</span><br></pre></td></tr></table></figure>
<p>For no/n-duplicate implementation:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>element-of-set: </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>adjoin-set: </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>union-set: </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>intersection-set: </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{element-of-set: }&amp; \Theta(n)\\
\text{adjoin-set: }&amp; \Theta(n)\\
\text{union-set: }&amp; \Theta(n^2)\\
\text{intersection-set: }&amp; \Theta(n^2)\\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.048216em;vertical-align:-2.774108em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.274108em;"><span style="top:-5.434108em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">element-of-set: </span></span></span></span><span style="top:-3.9341079999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">adjoin-set: </span></span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">union-set: </span></span></span></span><span style="top:-0.8858920000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">intersection-set: </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.774108em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.274108em;"><span style="top:-5.434108em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-3.9341079999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.8858920000000001em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.774108em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>For duplicate implementation:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>element-of-set: </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>adjoin-set: </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>union-set: </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>intersection-set: </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\text{element-of-set: }&amp; \Theta(n)\\
\text{adjoin-set: }&amp; \Theta(1)\\
\text{union-set: }&amp; \Theta(n)\\
\text{intersection-set: }&amp; \Theta(n)\\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.7500000000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">element-of-set: </span></span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">adjoin-set: </span></span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">union-set: </span></span></span></span><span style="top:-0.9099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">intersection-set: </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-0.9099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>Actually, I won’t use the duplicate implementation in application… Why not just use <code>list</code> or <code>vector</code>?</p>
<h4 id="exercise-261"><a class="markdownIt-Anchor" href="#exercise-261"></a> Exercise 2.61</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">element-of-set?</span> [x set] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> set) <span class="literal">false</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> x (<span class="name"><span class="builtin-name">first</span></span> set)) <span class="literal">true</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">&lt;</span></span> x (<span class="name"><span class="builtin-name">first</span></span> set)) <span class="literal">false</span></span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">recur</span></span> x (<span class="name"><span class="builtin-name">rest</span></span> set))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">adjoin-set</span> [x set] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> set) (<span class="name"><span class="builtin-name">list</span></span> x)</span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> x (<span class="name"><span class="builtin-name">first</span></span> set)) set</span><br><span class="line">        (<span class="name"><span class="builtin-name">&lt;</span></span> x (<span class="name"><span class="builtin-name">first</span></span> set)) (<span class="name"><span class="builtin-name">conj</span></span> set x)</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">adjoin-set</span> x (<span class="name"><span class="builtin-name">rest</span></span> set)) (<span class="name"><span class="builtin-name">first</span></span> set))))</span><br></pre></td></tr></table></figure>
<p>This algorithm can be optimized to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> with Dichotomic Search.</p>
<h4 id="exercise-262"><a class="markdownIt-Anchor" href="#exercise-262"></a> Exercise 2.62</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">union-set</span> [s1 s2]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> s2) s1</span><br><span class="line">        (<span class="name"><span class="builtin-name">empty?</span></span> s1) s2</span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> s1) (<span class="name"><span class="builtin-name">first</span></span> s2)) (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">union-set</span> (<span class="name"><span class="builtin-name">rest</span></span> s1) (<span class="name"><span class="builtin-name">rest</span></span> s2)) (<span class="name"><span class="builtin-name">first</span></span> s1))</span><br><span class="line">        (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">first</span></span> s1) (<span class="name"><span class="builtin-name">first</span></span> s2)) (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">union-set</span> (<span class="name"><span class="builtin-name">rest</span></span> s1) s2) (<span class="name"><span class="builtin-name">first</span></span> s1))</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">union-set</span> s1 (<span class="name"><span class="builtin-name">rest</span></span> s2)) (<span class="name"><span class="builtin-name">first</span></span> s2))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-263"><a class="markdownIt-Anchor" href="#exercise-263"></a> Exercise 2.63</h4>
<h5 id="1-2"><a class="markdownIt-Anchor" href="#1-2"></a> 1)</h5>
<p>Yes, they do.</p>
<h5 id="2-2"><a class="markdownIt-Anchor" href="#2-2"></a> 2)</h5>
<p><code>append</code> costs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> in Scheme, while <code>cons</code> costs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> in Scheme.</p>
<p>As a result, <code>tree-&gt;list-1</code> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, while <code>tree-&gt;list-2</code> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>.</p>
<h4 id="exercise-264"><a class="markdownIt-Anchor" href="#exercise-264"></a> Exercise 2.64</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">list-&gt;tree</span> [elements] </span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">partial-tree</span> [elts n]</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) (<span class="name"><span class="builtin-name">list</span></span> <span class="literal">nil</span> elts)</span><br><span class="line">      (<span class="name"><span class="builtin-name">let</span></span> [left-size (<span class="name"><span class="builtin-name">quot</span></span> (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>) <span class="number">2</span>) </span><br><span class="line">            right-size (<span class="name"><span class="builtin-name">-</span></span> n left-size <span class="number">1</span>) </span><br><span class="line">            [left-tree non-left-elts] (<span class="name">partial-tree</span> elts left-size) </span><br><span class="line">            [cur &amp; right-elts] non-left-elts</span><br><span class="line">            [right-tree left-elts] (<span class="name">partial-tree</span> right-elts right-size)]</span><br><span class="line">        (<span class="name"><span class="builtin-name">list</span></span> (<span class="name"><span class="builtin-name">list</span></span> cur left-tree right-tree) </span><br><span class="line">          left-elts))))</span><br><span class="line">  (<span class="name"><span class="builtin-name">first</span></span> (<span class="name">partial-tree</span> elements (<span class="name"><span class="builtin-name">count</span></span> elements))))</span><br><span class="line"></span><br><span class="line">(<span class="name">list-&gt;tree</span> &#x27;(<span class="number">1</span> <span class="number">3</span> <span class="number">5</span> <span class="number">7</span> <span class="number">9</span> <span class="number">11</span>))<span class="comment">; =&gt; (5 (1 nil (3 nil nil)) (9 (7 nil nil) (11 nil nil)))</span></span><br></pre></td></tr></table></figure>
<p><code>list-&gt;tree</code> is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>.</p>
<h4 id="exercise-265"><a class="markdownIt-Anchor" href="#exercise-265"></a> Exercise 2.65</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">val</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">L</span> second)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">R</span> last)</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">merge-seq</span> [s1 s2]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> s2) s1</span><br><span class="line">        (<span class="name"><span class="builtin-name">empty?</span></span> s1) s2</span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> s1) (<span class="name"><span class="builtin-name">first</span></span> s2)) (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">merge-seq</span> (<span class="name"><span class="builtin-name">rest</span></span> s1) (<span class="name"><span class="builtin-name">rest</span></span> s2)) (<span class="name"><span class="builtin-name">first</span></span> s1))</span><br><span class="line">        (<span class="name"><span class="builtin-name">&lt;</span></span> (<span class="name"><span class="builtin-name">first</span></span> s1) (<span class="name"><span class="builtin-name">first</span></span> s2)) (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">merge-seq</span> (<span class="name"><span class="builtin-name">rest</span></span> s1) s2) (<span class="name"><span class="builtin-name">first</span></span> s1))</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">merge-seq</span> s1 (<span class="name"><span class="builtin-name">rest</span></span> s2)) (<span class="name"><span class="builtin-name">first</span></span> s2))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">prefix-&gt;infix</span> [t]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">nil?</span></span> t) <span class="literal">nil</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">list</span></span> (<span class="name">prefix-&gt;infix</span> (<span class="name">L</span> t)) (<span class="name"><span class="builtin-name">val</span></span> t) (<span class="name">prefix-&gt;infix</span> (<span class="name">R</span> t)))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">tree-&gt;list</span> [t]</span><br><span class="line">  (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> t</span><br><span class="line">       (<span class="name">prefix-&gt;infix</span>)</span><br><span class="line">       (<span class="name"><span class="builtin-name">flatten</span></span>)</span><br><span class="line">       (<span class="name"><span class="builtin-name">filter</span></span> #(<span class="name"><span class="builtin-name">not</span></span> (<span class="name"><span class="builtin-name">nil?</span></span> %)))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">union-set</span> [s1 s2] (<span class="name">list-&gt;tree</span> (<span class="name">merge-seq</span> (<span class="name">tree-&gt;list</span> s1) (<span class="name">tree-&gt;list</span> s2))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-266"><a class="markdownIt-Anchor" href="#exercise-266"></a> Exercise 2.66</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">lookup</span> [given-key root]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">nil?</span></span> root) <span class="literal">false</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> given-key (<span class="name"><span class="builtin-name">key</span></span> root)) (<span class="name"><span class="builtin-name">val</span></span> root)</span><br><span class="line">        (<span class="name"><span class="builtin-name">&lt;</span></span> given-key (<span class="name"><span class="builtin-name">key</span></span> root)) (<span class="name"><span class="builtin-name">recur</span></span> given-key (<span class="name">L</span> root))</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">recur</span></span> given-key (<span class="name">R</span> root))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-267"><a class="markdownIt-Anchor" href="#exercise-267"></a> Exercise 2.67</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">leaf</span> [symbol weight]</span><br><span class="line">  (<span class="name"><span class="builtin-name">list</span></span> &#x27;leaf symbol weight))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">leaf?</span> [x] (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">first</span></span> x) &#x27;leaf))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">symbol-leaf</span> second)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">weight</span> last)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">L</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">R</span> second)</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">symbols</span> [x]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">leaf?</span> x) (<span class="name"><span class="builtin-name">list</span></span> (<span class="name">symbol-leaf</span> x)) (<span class="name"><span class="builtin-name">nth</span></span> x <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">code-tree</span> [left right]</span><br><span class="line">  (<span class="name"><span class="builtin-name">list</span></span> left right (<span class="name"><span class="builtin-name">concat</span></span> (<span class="name">symbols</span> left) (<span class="name">symbols</span> right)) (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">weight</span> left) (<span class="name">weight</span> right))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">choose-branch</span> [bit branch]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">=</span></span> bit <span class="number">0</span>) (<span class="name">L</span> branch)</span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> bit <span class="number">1</span>) (<span class="name">R</span> branch)</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">throw</span></span> (<span class="name">Exception.</span> (<span class="name"><span class="builtin-name">str</span></span> <span class="string">&quot;bad bit: CHOOSE-BRANCH `&quot;</span> bit <span class="string">&quot;`&quot;</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">decode</span> [bits tree] </span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">decode-1</span> [bits cur]</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> bits) ()</span><br><span class="line">      (<span class="name"><span class="builtin-name">let</span></span> [next (<span class="name">choose-branch</span> (<span class="name"><span class="builtin-name">first</span></span> bits) cur)]</span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">leaf?</span> next) </span><br><span class="line">          (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name">decode-1</span> (<span class="name"><span class="builtin-name">rest</span></span> bits) tree) (<span class="name">symbol-leaf</span> next))</span><br><span class="line">          (<span class="name"><span class="builtin-name">recur</span></span> (<span class="name"><span class="builtin-name">rest</span></span> bits) next)))))</span><br><span class="line">  (<span class="name">decode-1</span> bits tree))</span><br><span class="line"></span><br><span class="line"><span class="comment">; The `make-leaf-set` implementation on the book is but a insertion sort.</span></span><br><span class="line"><span class="comment">; It&#x27;s better to used the sort function implemented by Clojure, with a time complexity of O(nlogn)</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-leaf-set</span> [pairs]</span><br><span class="line">  (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> pairs </span><br><span class="line">       (<span class="name"><span class="builtin-name">sort-by</span></span> weight)</span><br><span class="line">       (<span class="name"><span class="builtin-name">map</span></span> #(<span class="name"><span class="builtin-name">conj</span></span> % &#x27;leaf))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">sample-tree</span> (<span class="name">code-tree</span> (<span class="name">leaf</span> &#x27;A <span class="number">4</span>) (<span class="name">code-tree</span> (<span class="name">leaf</span> &#x27;B <span class="number">2</span>) (<span class="name">code-tree</span> (<span class="name">leaf</span> &#x27;D <span class="number">1</span>) (<span class="name">leaf</span> &#x27;C <span class="number">1</span>)))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">sample-message</span> &#x27;(<span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-268"><a class="markdownIt-Anchor" href="#exercise-268"></a> Exercise 2.68</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">encode-symbol</span> (<span class="name"><span class="builtin-name">memoize</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [tree sym]</span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">travel</span> [rt cur]</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name">leaf?</span> rt) </span><br><span class="line">        (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name">symbol-leaf</span> rt) sym) cur <span class="literal">false</span>)</span><br><span class="line">      (<span class="name"><span class="builtin-name">or</span></span> (<span class="name">travel</span> (<span class="name">L</span> rt) (<span class="name"><span class="builtin-name">conj</span></span> cur <span class="number">0</span>))</span><br><span class="line">           (<span class="name">travel</span> (<span class="name">R</span> rt) (<span class="name"><span class="builtin-name">conj</span></span> cur <span class="number">1</span>)))))</span><br><span class="line">  (<span class="name"><span class="builtin-name">apply</span></span> list (<span class="name">travel</span> tree [])))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">encode</span> [message tree]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">empty?</span></span> message) ()</span><br><span class="line">    (<span class="name"><span class="builtin-name">concat</span></span> (<span class="name">encode-symbol</span> tree (<span class="name"><span class="builtin-name">first</span></span> message)) (<span class="name">encode</span> (<span class="name"><span class="builtin-name">rest</span></span> message) tree))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-269"><a class="markdownIt-Anchor" href="#exercise-269"></a> Exercise 2.69</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; https://stackoverflow.com/questions/10942607/clojure-multi-maps</span></span><br><span class="line">(<span class="name"><span class="builtin-name">ns</span></span> #<span class="comment">^&#123;:doc &quot;A multimap is a map that permits multiple values for each</span></span><br><span class="line"><span class="comment">  key.  In Clojure we can represent a multimap as a map with sets as</span></span><br><span class="line"><span class="comment">  values.&quot;&#125;</span></span><br><span class="line">  multimap</span><br><span class="line">  (<span class="symbol">:use</span> [clojure.set <span class="symbol">:only</span> (<span class="name"><span class="builtin-name">union</span></span>)]))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">first</span> [mm]</span><br><span class="line">  <span class="string">&quot;Get the first key-value pair in the multimap. O(log(n))&quot;</span></span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [[k vs] (<span class="name">clojure.core/first</span> mm)]</span><br><span class="line">    [k (<span class="name">clojure.core/first</span> vs)]))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">rest</span> [mm]</span><br><span class="line">  <span class="string">&quot;Get the multimap after dropping the first key-value pair. O(log(n))&quot;</span></span><br><span class="line">   (<span class="name"><span class="builtin-name">let</span></span> [[k v] (<span class="name"><span class="builtin-name">first</span></span> mm)]</span><br><span class="line">     (<span class="name">del</span> mm k v)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">second</span> [mm]</span><br><span class="line">  (<span class="name"><span class="builtin-name">first</span></span> (<span class="name"><span class="builtin-name">rest</span></span> mm)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">add</span></span><br><span class="line">  <span class="string">&quot;Adds key-value pairs the multimap.&quot;</span></span><br><span class="line">  ([mm k v]</span><br><span class="line">     (<span class="name"><span class="builtin-name">assoc</span></span> mm k (<span class="name"><span class="builtin-name">conj</span></span> (<span class="name"><span class="builtin-name">get</span></span> mm k #&#123;&#125;) v)))</span><br><span class="line">  ([mm k v &amp; kvs]</span><br><span class="line">     (<span class="name"><span class="builtin-name">apply</span></span> add (<span class="name">add</span> mm k v) kvs)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">del</span></span><br><span class="line">  <span class="string">&quot;Removes key-value pairs from the multimap.&quot;</span></span><br><span class="line">  ([mm k v]</span><br><span class="line">     (<span class="name"><span class="builtin-name">let</span></span> [mmv (<span class="name"><span class="builtin-name">disj</span></span> (<span class="name"><span class="builtin-name">get</span></span> mm k) v)]</span><br><span class="line">       (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">seq</span></span> mmv)</span><br><span class="line">         (<span class="name"><span class="builtin-name">assoc</span></span> mm k mmv)</span><br><span class="line">         (<span class="name"><span class="builtin-name">dissoc</span></span> mm k))))</span><br><span class="line">  ([mm k v &amp; kvs]</span><br><span class="line">     (<span class="name"><span class="builtin-name">apply</span></span> del (<span class="name">del</span> mm k v) kvs)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">mm-merge</span></span><br><span class="line">  <span class="string">&quot;Merges the multimaps, taking the union of values.&quot;</span></span><br><span class="line">  [&amp; mms]</span><br><span class="line">  (<span class="name"><span class="builtin-name">apply</span></span> (<span class="name"><span class="builtin-name">partial</span></span> merge-with union) mms))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">ns</span></span> user)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">successive-merge</span> [cnt pairs]</span><br><span class="line">  (<span class="keyword">defn</span> <span class="title">iter</span> [pairs n]</span><br><span class="line">    (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) (<span class="name"><span class="builtin-name">second</span></span> (<span class="name">multimap/first</span> pairs))</span><br><span class="line">      (<span class="name"><span class="builtin-name">let</span></span> [new-node (<span class="name">code-tree</span> (<span class="name"><span class="builtin-name">second</span></span> (<span class="name">multimap/first</span> pairs)) (<span class="name"><span class="builtin-name">second</span></span> (<span class="name">multimap/second</span> pairs))) </span><br><span class="line">            rest-pairs (<span class="name">multimap/rest</span> (<span class="name">multimap/rest</span> pairs))]</span><br><span class="line">        (<span class="name"><span class="builtin-name">recur</span></span> (<span class="name">multimap/add</span> rest-pairs (<span class="name">weight</span> new-node) new-node) (<span class="name"><span class="builtin-name">-</span></span> n <span class="number">1</span>)))))</span><br><span class="line">  (<span class="name">iter</span> pairs (<span class="name"><span class="builtin-name">-</span></span> cnt <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">huffman-tree</span> [pairs]</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [cnt (<span class="name"><span class="builtin-name">count</span></span> pairs)]</span><br><span class="line">    (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> pairs</span><br><span class="line">         (<span class="name">make-leaf-set</span>)</span><br><span class="line">         (<span class="name"><span class="builtin-name">reduce</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [cur i] (<span class="name">multimap/add</span> cur (<span class="name">weight</span> i) i)) (<span class="name"><span class="builtin-name">sorted-map</span></span>))</span><br><span class="line">         (<span class="name">successive-merge</span> cnt))))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-270"><a class="markdownIt-Anchor" href="#exercise-270"></a> Exercise 2.70</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">def</span> <span class="title">dictionary</span> (<span class="name">huffman-tree</span> &#x27;((<span class="name">A</span> <span class="number">2</span>) (<span class="name">NA</span> <span class="number">16</span>) (<span class="name">BOOM</span> <span class="number">1</span>) (<span class="name">SHA</span> <span class="number">3</span>) (<span class="name">GET</span> <span class="number">2</span>) (<span class="name">YIP</span> <span class="number">9</span>) (<span class="name">JOB</span> <span class="number">2</span>) (<span class="name">WAH</span> <span class="number">1</span>))))</span><br><span class="line">(<span class="keyword">def</span> <span class="title">message</span> &#x27;(<span class="name">GET</span> A JOB SHA NA NA NA NA NA NA NA NA GET A JOB SHA NA NA NA NA NA NA NA NA WAH YIP YIP YIP YIP YIP YIP YIP YIP YIP SHA BOOM))</span><br><span class="line">(<span class="name">encode</span> message dictionary)<span class="comment">; 84 bit in total</span></span><br></pre></td></tr></table></figure>
<p>For a fixed-length code, it would take <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>36</mn><mo>×</mo><mn>3</mn><mo>=</mo><mn>108</mn><mtext>(bits)</mtext></mrow><annotation encoding="application/x-tex">36 \times 3 = 108 \text{(bits)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">8</span><span class="mord text"><span class="mord">(bits)</span></span></span></span></span>.</p>
<h4 id="exercise-271"><a class="markdownIt-Anchor" href="#exercise-271"></a> Exercise 2.71</h4>
<p>I just draw it for n = 2, n = 5 and n = 10 are similar.</p>
<p><img src="2-71-hoffman-tree-example.png" alt="A chain like Hoffman Tree for n = 2." /></p>
<p>It requires 1 bit to encode the most frequent symbol, while <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> bit to encode the least frequent symbol.</p>
<h4 id="exercise-272"><a class="markdownIt-Anchor" href="#exercise-272"></a> Exercise 2.72</h4>
<p>It takes <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> to encode the most frequent symbol in Exercise 2.71, while <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> to encode the least frequent symbol in Exercise 2.71.</p>
<h4 id="exercise-273"><a class="markdownIt-Anchor" href="#exercise-273"></a> Exercise 2.73</h4>
<h5 id="1-3"><a class="markdownIt-Anchor" href="#1-3"></a> 1)</h5>
<p>The code treat the exp as a general kind of data, tagged <code>sum</code> or <code>product</code>. Then it seperate the differentiation part of each implementation out of the general <code>deriv</code> function.</p>
<p><code>number</code> and <code>variable</code> are special since they don’t act like some operation, operating on operators and operands.</p>
<h5 id="2-3"><a class="markdownIt-Anchor" href="#2-3"></a> 2) &amp; 3)</h5>
<p>Clojure requires pure functional programming, so there’s no way to “install” some modules.</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">drop-nth</span> [n coll]</span><br><span class="line">   (<span class="name">keep-indexed</span> #(<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">not=</span></span> %<span class="number">1</span> n) %<span class="number">2</span>) coll))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">variable?</span> symbol?)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">operator</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">operands</span> rest)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">deriv</span>)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-sum</span> [a1 a2] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">=</span></span> a1 <span class="number">0</span>) a2 </span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> a2 <span class="number">0</span>) a1</span><br><span class="line">        (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">number?</span></span> a1) (<span class="name"><span class="builtin-name">number?</span></span> a2)) (<span class="name"><span class="builtin-name">+</span></span> a1 a2)</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">list</span></span> &#x27;+ a1 a2)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-product</span> [a1 a2] </span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">=</span></span> a1 <span class="number">0</span>) (<span class="name"><span class="builtin-name">=</span></span> a2 <span class="number">0</span>)) <span class="number">0</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> a1 <span class="number">1</span>) a2</span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> a2 <span class="number">1</span>) a1</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">list</span></span> &#x27;* a1 a2)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">make-exponentiation</span> [u n]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">or</span></span> (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">0</span>) (<span class="name"><span class="builtin-name">=</span></span> u <span class="number">1</span>)) <span class="number">1</span></span><br><span class="line">        (<span class="name"><span class="builtin-name">=</span></span> n <span class="number">1</span>) u</span><br><span class="line">        <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">list</span></span> &#x27;** u n)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">addend</span> first)</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">augend</span> [exp]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">count</span></span> exp) <span class="number">2</span>) (<span class="name"><span class="builtin-name">second</span></span> exp) (<span class="name"><span class="builtin-name">concat</span></span> &#x27;(<span class="name"><span class="builtin-name">+</span></span>) (<span class="name"><span class="builtin-name">rest</span></span> exp))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">deriv-+</span> [exp var]</span><br><span class="line">  (<span class="name">make-sum</span> (<span class="name">deriv</span> (<span class="name">addend</span> exp) var)</span><br><span class="line">            (<span class="name">deriv</span> (<span class="name">augend</span> exp) var)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">multiplier</span> first)</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">multiplicand</span> [exp]</span><br><span class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> (<span class="name"><span class="builtin-name">count</span></span> exp) <span class="number">2</span>) (<span class="name"><span class="builtin-name">second</span></span> exp) (<span class="name"><span class="builtin-name">concat</span></span> &#x27;(<span class="name"><span class="builtin-name">*</span></span>) (<span class="name"><span class="builtin-name">rest</span></span> exp))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">deriv-*</span> [exp var]</span><br><span class="line">  (<span class="name">make-sum</span> (<span class="name">make-product</span> </span><br><span class="line">              (<span class="name">multiplier</span> exp)</span><br><span class="line">              (<span class="name">deriv</span> (<span class="name">multiplicand</span> exp) var))</span><br><span class="line">            (<span class="name">make-product</span> </span><br><span class="line">              (<span class="name">deriv</span> (<span class="name">multiplier</span> exp) var)</span><br><span class="line">              (<span class="name">multiplicand</span> exp))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">base</span> first)</span><br><span class="line">(<span class="keyword">def</span> <span class="title">exponent</span> second)</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">deriv-**</span> [exp var]</span><br><span class="line">  (<span class="name">make-product</span> (<span class="name">make-product</span> </span><br><span class="line">                  (<span class="name">exponent</span> exp)</span><br><span class="line">                  (<span class="name">make-exponentiation</span></span><br><span class="line">                    (<span class="name">base</span> exp) </span><br><span class="line">                    (<span class="name">make-sum</span> (<span class="name">exponent</span> exp) <span class="number">-1</span>))) </span><br><span class="line">                (<span class="name">deriv</span> (<span class="name">base</span> exp) var)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="keyword">def</span> <span class="title">ops-map</span> &#123;</span><br><span class="line">  [&#x27;deriv &#x27;+] deriv-+, </span><br><span class="line">  [&#x27;deriv &#x27;*] deriv-*,</span><br><span class="line">  [&#x27;deriv &#x27;**] deriv-**</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">deriv</span> [exp var]</span><br><span class="line">  (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">number?</span></span> exp) <span class="number">0</span></span><br><span class="line">        (<span class="name">variable?</span> exp)</span><br><span class="line">          (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">=</span></span> exp var) <span class="number">1</span> <span class="number">0</span>)</span><br><span class="line">        <span class="symbol">:else</span></span><br><span class="line">          ((<span class="name"><span class="builtin-name">get</span></span> ops-map [&#x27;deriv (<span class="name">operator</span> exp)]) (<span class="name">operands</span> exp) var)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="4"><a class="markdownIt-Anchor" href="#4"></a> 4)</h5>
<p>In the example on the book, you should only change the implementation of <code>get</code>, <code>put</code>, and calls to them.</p>
<p>In my code you can just change the map <code>ops-map</code> and the calls to the function <code>get</code>.</p>
<h4 id="exercise-274"><a class="markdownIt-Anchor" href="#exercise-274"></a> Exercise 2.74</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">get-record</span> </span><br><span class="line">  <span class="string">&quot;the employee&#x27;s id and the file should be supplied. &quot;</span></span><br><span class="line">  ([id file] <span class="comment">; O(n)</span></span><br><span class="line">    (<span class="name"><span class="builtin-name">first</span></span> </span><br><span class="line">      (<span class="name"><span class="builtin-name">for</span></span> [record file</span><br><span class="line">            <span class="symbol">:let</span> [cur-id (<span class="symbol">:id</span> record)]</span><br><span class="line">            <span class="symbol">:when</span> (<span class="name"><span class="builtin-name">=</span></span> cur-id id)] record))))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">find-employee-record</span> </span><br><span class="line">  <span class="string">&quot;The set of all files should be supplied. </span></span><br><span class="line"><span class="string">   It should be structured like this: </span></span><br><span class="line"><span class="string">   &#x27;((&#123;:id Tom :salary 10&#125; &#123;:id Jerry :salary 100&#125;) </span></span><br><span class="line"><span class="string">     (&#123;:id Alpha :salary 10&#125; &#123;:id Bravo :salary 100&#125;))</span></span><br><span class="line"><span class="string">   That is, a list of list of maps. &quot;</span></span><br><span class="line">  ([id files] <span class="comment">; O(n)</span></span><br><span class="line">    (<span class="name">some</span> #(<span class="name">get-record</span> id %) files)))</span><br><span class="line"></span><br><span class="line">(<span class="keyword">defn</span> <span class="title">get-salary</span> [id files] </span><br><span class="line">  (<span class="symbol">:salary</span> (<span class="name">find-employee-record</span> id files)))</span><br></pre></td></tr></table></figure>
<p>Only change the function <code>get-record</code>.</p>
<h4 id="exercise-275"><a class="markdownIt-Anchor" href="#exercise-275"></a> Exercise 2.75</h4>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">defn</span> <span class="title">make-from-mag-ang</span> [rho theta]</span><br><span class="line">  (<span class="name"><span class="builtin-name">fn</span></span> [op]</span><br><span class="line">    (<span class="name"><span class="builtin-name">cond</span></span> (<span class="name"><span class="builtin-name">=</span></span> op &#x27;real-part) (<span class="name"><span class="builtin-name">*</span></span> rho (<span class="name">Math/cos</span> theta))</span><br><span class="line">          (<span class="name"><span class="builtin-name">=</span></span> op &#x27;imag-part) (<span class="name"><span class="builtin-name">*</span></span> rho (<span class="name">Math/sin</span> theta))</span><br><span class="line">          (<span class="name"><span class="builtin-name">=</span></span> op &#x27;magnitude) rho</span><br><span class="line">          (<span class="name"><span class="builtin-name">=</span></span> op &#x27;angle) theta</span><br><span class="line">          <span class="symbol">:else</span> (<span class="name"><span class="builtin-name">throw</span></span> (<span class="name">Exception.</span> (<span class="name"><span class="builtin-name">str</span></span> <span class="string">&quot;Unknown op: MAKE-FROM-MAG-ANG&quot;</span> op))))))</span><br><span class="line">(<span class="keyword">defn</span> <span class="title">apply-generic</span> [op arg] (<span class="name">arg</span> op))</span><br></pre></td></tr></table></figure>
<h4 id="exercise-276"><a class="markdownIt-Anchor" href="#exercise-276"></a> Exercise 2.76</h4>
<p>For explicit dispatch:</p>
<p>every operation should be implement as a conditional procudure, considering different inputs.</p>
<p>For data-directed style:</p>
<p>operations on types forms a 2-dimension array, implementation of the operations are in the arrays.</p>
<p>For message-passing style:</p>
<p>The operations on a specific types should always be implemented in the definition of that type.</p>
<p>For a system in which new types must be often added, message-passing style is more appropriate.</p>
<p>For a system in which new operations must often be added, explicit dispatch is more appropriate.</p>
<h4 id="exercise-277"><a class="markdownIt-Anchor" href="#exercise-277"></a> Exercise 2.77</h4>
<p>This adds a interface for the <code>complex</code> numbers, so it works.</p>
<p>For the second question, my implementation differs from the one on the book (I’m using clojure).</p>
<p>In my implementation, I straightly call the functions in the module <code>complex</code>, so no <code>apply-generic</code> is called.</p>
<p>The <code>magnitude</code> function calls  <code>complex/magnitude</code>, and then <code>base/val</code>.</p>
<h4 id="exercise-278~281-283-~-285"><a class="markdownIt-Anchor" href="#exercise-278~281-283-~-285"></a> Exercise 2.78~2.81, 2.83 ~ 2.85</h4>
<p>See: <a target="_blank" rel="noopener" href="https://github.com/glyh/sicp-solutions-clojure/tree/main/src/sicp_solutions_clojure/chapter_2/algebraic_system">sicp-solutions on my github.</a></p>
<h4 id="exercise-281"><a class="markdownIt-Anchor" href="#exercise-281"></a> Exercise 2.81</h4>
<p>Stack overflows, since the function keeps calling itself.</p>
<h4 id="exercise-282"><a class="markdownIt-Anchor" href="#exercise-282"></a> Exercise 2.82</h4>
<p>The method mentioned in the question is not good, for example, we have type a, b and c.</p>
<p>Let’s say a, b and c are all supertypes of some d, but there’s no way to convert between them.</p>
<p>If so, trying to coerce between them won’t lay out the result we want.</p>
<p>A proper way to solve this, might be treat the types relationships as a <abbr title="Directed Acyclic Graph">DAG</abbr>. For each variable x to be applied by the operation,add a set on the node with the type in it, unioning the sets in the direction of the edges goes, and see whether there’s some type have all types of inputed variables.</p>
<p>If there is some type fullfilled the requirements, then we can coerce to that type; If not we can’t apply this method.</p>
<p>This is only a trivial solution. There might be better ways, but requires deeper knowledges on algorithms.</p>
<h4 id="exercise-286"><a class="markdownIt-Anchor" href="#exercise-286"></a> Exercise 2.86</h4>
<p>Nothing to change since ratio is treated as primitive in Clojure.</p>
<p>If you stick to this, we could insert some layers between <code>complex</code> and the under layers it relies on.</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/algorithms/" rel="tag"># algorithms</a>
              <a href="/tags/principles/" rel="tag"># principles</a>
              <a href="/tags/SICP/" rel="tag"># SICP</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/01/17/SICP-Solutions-in-Clojure-Chapter-1/" rel="prev" title="SICP Solutions in Clojure (Chapter 1)">
      <i class="fa fa-chevron-left"></i> SICP Solutions in Clojure (Chapter 1)
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-21"><span class="nav-number">1.</span> <span class="nav-text"> Exercise 2.1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-22"><span class="nav-number">2.</span> <span class="nav-text"> Exercise 2.2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-23"><span class="nav-number">3.</span> <span class="nav-text"> Exercise 2.3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-24"><span class="nav-number">4.</span> <span class="nav-text"> Exercise 2.4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-25"><span class="nav-number">5.</span> <span class="nav-text"> Exercise 2.5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-26"><span class="nav-number">6.</span> <span class="nav-text"> Exercise 2.6</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-27"><span class="nav-number">7.</span> <span class="nav-text"> Exercise 2.7</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-28"><span class="nav-number">8.</span> <span class="nav-text"> Exercise 2.8</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-29"><span class="nav-number">9.</span> <span class="nav-text"> Exercise 2.9</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-210"><span class="nav-number">10.</span> <span class="nav-text"> Exercise 2.10</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-211"><span class="nav-number">11.</span> <span class="nav-text"> Exercise 2.11</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-212"><span class="nav-number">12.</span> <span class="nav-text"> Exercise 2.12</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-213"><span class="nav-number">13.</span> <span class="nav-text"> Exercise 2.13</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-214"><span class="nav-number">14.</span> <span class="nav-text"> Exercise 2.14</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-215"><span class="nav-number">15.</span> <span class="nav-text"> Exercise 2.15</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-216"><span class="nav-number">16.</span> <span class="nav-text"> Exercise 2.16</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-217"><span class="nav-number">17.</span> <span class="nav-text"> Exercise 2.17</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-218"><span class="nav-number">18.</span> <span class="nav-text"> Exercise 2.18</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-219"><span class="nav-number">19.</span> <span class="nav-text"> Exercise 2.19</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-220"><span class="nav-number">20.</span> <span class="nav-text"> Exercise 2.20</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-221"><span class="nav-number">21.</span> <span class="nav-text"> Exercise 2.21</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-222"><span class="nav-number">22.</span> <span class="nav-text"> Exercise 2.22</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-223"><span class="nav-number">23.</span> <span class="nav-text"> Exercise 2.23</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-224"><span class="nav-number">24.</span> <span class="nav-text"> Exercise 2.24</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-225"><span class="nav-number">25.</span> <span class="nav-text"> Exercise 2.25</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-226"><span class="nav-number">26.</span> <span class="nav-text"> Exercise 2.26</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-227"><span class="nav-number">27.</span> <span class="nav-text"> Exercise 2.27</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-228"><span class="nav-number">28.</span> <span class="nav-text"> Exercise 2.28</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-229"><span class="nav-number">29.</span> <span class="nav-text"> Exercise 2.29</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-230"><span class="nav-number">30.</span> <span class="nav-text"> Exercise 2.30</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-231"><span class="nav-number">31.</span> <span class="nav-text"> Exercise 2.31</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-232"><span class="nav-number">32.</span> <span class="nav-text"> Exercise 2.32</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-233"><span class="nav-number">33.</span> <span class="nav-text"> Exercise 2.33</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-234"><span class="nav-number">34.</span> <span class="nav-text"> Exercise 2.34</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-235"><span class="nav-number">35.</span> <span class="nav-text"> Exercise 2.35</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-236"><span class="nav-number">36.</span> <span class="nav-text"> Exercise 2.36</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-237"><span class="nav-number">37.</span> <span class="nav-text"> Exercise 2.37</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-238"><span class="nav-number">38.</span> <span class="nav-text"> Exercise 2.38</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-239"><span class="nav-number">39.</span> <span class="nav-text"> Exercise 2.39</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-240"><span class="nav-number">40.</span> <span class="nav-text"> Exercise 2.40</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-241"><span class="nav-number">41.</span> <span class="nav-text"> Exercise 2.41</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-242"><span class="nav-number">42.</span> <span class="nav-text"> Exercise 2.42</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-243"><span class="nav-number">43.</span> <span class="nav-text"> Exercise 2.43</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-244"><span class="nav-number">44.</span> <span class="nav-text"> Exercise 2.44</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-245"><span class="nav-number">45.</span> <span class="nav-text"> Exercise 2.45</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-246"><span class="nav-number">46.</span> <span class="nav-text"> Exercise 2.46</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-247"><span class="nav-number">47.</span> <span class="nav-text"> Exercise 2.47</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-248"><span class="nav-number">48.</span> <span class="nav-text"> Exercise 2.48</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-249"><span class="nav-number">49.</span> <span class="nav-text"> Exercise 2.49</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-250"><span class="nav-number">50.</span> <span class="nav-text"> Exercise 2.50</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-251"><span class="nav-number">51.</span> <span class="nav-text"> Exercise 2.51</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-252"><span class="nav-number">52.</span> <span class="nav-text"> Exercise 2.52</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-253"><span class="nav-number">53.</span> <span class="nav-text"> Exercise 2.53</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-254"><span class="nav-number">54.</span> <span class="nav-text"> Exercise 2.54</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-255"><span class="nav-number">55.</span> <span class="nav-text"> Exercise 2.55</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-256"><span class="nav-number">56.</span> <span class="nav-text"> Exercise 2.56</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-257"><span class="nav-number">57.</span> <span class="nav-text"> Exercise 2.57</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-258"><span class="nav-number">58.</span> <span class="nav-text"> Exercise 2.58</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1"><span class="nav-number">58.1.</span> <span class="nav-text"> 1)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2"><span class="nav-number">58.2.</span> <span class="nav-text"> 2)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-259"><span class="nav-number">59.</span> <span class="nav-text"> Exercise 2.59</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-260"><span class="nav-number">60.</span> <span class="nav-text"> Exercise 2.60</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-261"><span class="nav-number">61.</span> <span class="nav-text"> Exercise 2.61</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-262"><span class="nav-number">62.</span> <span class="nav-text"> Exercise 2.62</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-263"><span class="nav-number">63.</span> <span class="nav-text"> Exercise 2.63</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-2"><span class="nav-number">63.1.</span> <span class="nav-text"> 1)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2"><span class="nav-number">63.2.</span> <span class="nav-text"> 2)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-264"><span class="nav-number">64.</span> <span class="nav-text"> Exercise 2.64</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-265"><span class="nav-number">65.</span> <span class="nav-text"> Exercise 2.65</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-266"><span class="nav-number">66.</span> <span class="nav-text"> Exercise 2.66</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-267"><span class="nav-number">67.</span> <span class="nav-text"> Exercise 2.67</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-268"><span class="nav-number">68.</span> <span class="nav-text"> Exercise 2.68</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-269"><span class="nav-number">69.</span> <span class="nav-text"> Exercise 2.69</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-270"><span class="nav-number">70.</span> <span class="nav-text"> Exercise 2.70</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-271"><span class="nav-number">71.</span> <span class="nav-text"> Exercise 2.71</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-272"><span class="nav-number">72.</span> <span class="nav-text"> Exercise 2.72</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-273"><span class="nav-number">73.</span> <span class="nav-text"> Exercise 2.73</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-3"><span class="nav-number">73.1.</span> <span class="nav-text"> 1)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-3"><span class="nav-number">73.2.</span> <span class="nav-text"> 2) &amp; 3)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4"><span class="nav-number">73.3.</span> <span class="nav-text"> 4)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-274"><span class="nav-number">74.</span> <span class="nav-text"> Exercise 2.74</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-275"><span class="nav-number">75.</span> <span class="nav-text"> Exercise 2.75</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-276"><span class="nav-number">76.</span> <span class="nav-text"> Exercise 2.76</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-277"><span class="nav-number">77.</span> <span class="nav-text"> Exercise 2.77</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-278~281-283-~-285"><span class="nav-number">78.</span> <span class="nav-text"> Exercise 2.78~2.81, 2.83 ~ 2.85</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-281"><span class="nav-number">79.</span> <span class="nav-text"> Exercise 2.81</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-282"><span class="nav-number">80.</span> <span class="nav-text"> Exercise 2.82</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exercise-286"><span class="nav-number">81.</span> <span class="nav-text"> Exercise 2.86</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Lyhokia</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lyhokia</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  













<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'dark',
      themeVariables : {darkMode: true},
      logLevel : 3,
      flowchart: { curve     : 'linear', htmlLabels: false },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
      
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css">


  

</body>
</html>
